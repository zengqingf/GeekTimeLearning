# 不同编程语言统一的编码规范

### 语言特点



* C++

  * 头文件 

    ``` c++
    //头文件包含采用以下顺序: 本身头文件 >> C库头文件 >> C++库 >> 第三方库头文件 >> Avalon头文件 >> CommonLib头文件 >> 本项目头文件
        
    #include "test.h"
     
    // C库
    #include <stdio.h>
     
    // C++库
    #include <vector>
     
    // 第三方库
    #include <boost/...>
     
    // Avalon
    #include <AvalonDefine.h>
     
    // CommonLib
    #include <CLDefine.h>
     
    // 本地工程
    #include "SSPlayer.h"
    #include "SSItem.h"
    ```

  * #define保护

    ``` c++
    //所有头文件都应该使用 #define 来防止头文件被多重包含, 命名格式当是: _<FILE>_H_ .
    
    //客户端
    #pragram once
     
    
    #ifndef _TEST_H_
    #define _TEST_H_
    ...
    #endif  //_TEST_H_
    ```

  * 内联inline

    ``` c++
    //简单的函数（如Get/Set）鼓励使用内联。
    ```

  * 类

    ``` text
    构造函数
    不要在构造函数中调用虚函数, 也不要在无法报出错误时进行可能失败的初始化.
    析构函数
    若一个类需要被继承，析构函数一定要定义为虚函数。
    结构体 VS 类
    仅当只有数据成员时使用struct, 其它一概使用class(可以有一些数据相关的函数，如Init, Clear, Reset...)。
    ```

  * 函数

    ``` text
    参数顺序: 函数的参数顺序为: 输入参数在先, 后跟输出参数.
    
    引用传递的参数尽量都加上const.
    
    Get函数都定义为const函数   
    UInt32 Get() const { return 111; }
    ```
    
    

* C#

  * link: 

    [C#编码规范](https://gist.github.com/zhuqling/a2700703d088b8746f0c)

    [C#编码规范](https://ldqk.org/1755)

    [C# Coding Conventions (C# Programming Guide)](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/inside-a-program/coding-conventions)

  * 



* Java

  * link:

    [Java命名规范](https://github.com/Snailclimb/JavaGuide/blob/master/docs/system-design/naming.md)

    [Java命名规范](https://www.cnblogs.com/liqiangchn/p/12000361.html)

    [Google Java 编程风格指南](https://hawstein.com/2014/01/20/google-java-style/)

    [Google Java Style Guide](https://google.github.io/styleguide/javaguide.html)

  * 包名

    ``` text
    priv.个人名.项目名.模块名
    pers.个人名.项目名.模块名
    
    team.团队名.项目名.模块名
    
    com.公司名.项目名.模块名
    
    indi.发起者名.项目名.模块名
    ```



---



* Python

  * link

    [Python风格规范](https://zh-google-styleguide.readthedocs.io/en/latest/google-python-styleguide/contents/)

    [Python 开发编码规范](https://github.com/yongxinz/tech-blog/blob/master/python/Python%20%E5%BC%80%E5%8F%91%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83.md)

    

* Lua

  * link

    [Lua代码编写规范](https://www.kancloud.cn/digest/luanote/119941)

    [Lua代码风格指南](https://wuzhiwei.net/lua_style_guide/)

    [Lua代码规范](https://www.lt-tree.com/2018/12/26/Lua%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83/)

    [代码规范](https://moonbingbing.gitbooks.io/openresty-best-practices/content/web/code_style.html)

    [lua 编码规范](https://abaojin.github.io/2020/04/25/lua-coding-standard/)
    
  * 工作中的规范 
  
    __UnLua with UnrealEngine in Tenmove__
  
    ``` lua
    类的命名
    所有类命名时使用大驼峰法，即每个单词首字母大写。
    
    例：local MainTownFrame = class('MainTownFrame', FrameBase)
    并且要求lua文件名与类名保持一致。
    
    
    函数命名
    统一使用大驼峰法，即每个单词首字母大写；不再使用之前定的私有函数加“_”符号。
    例：function MainTownFrame:OnOpenFrame(view, layer, param)
        
        
    变量命名
    使用小驼峰式命名法：每一个单字的首字母都采用大写字母，例如：firstName、lastName、camelCase。与函数名以及类名做区分。 
    例：local serverData = nil
    类的成员变量前统一加m，例: self.mLayer；并且类中的成员变量需要在init中先声明，并赋予初始值，不允许不声明直接使用。
    全局变量定义在Global文件内统一管理，使用大驼峰命名，首字母要大写。
        
    文件内局部require的变量也使用大驼峰命名：
    local CLSkillProtocol = require("Path...")
    总结：不管是在global文件内，还是在其他地方，require的变量都统一使用大驼峰命名法。
        
    除非是局部变量功能等价全局变量，不然局部变量不要与已有的全局变量同名（这也是为什么全局变量尽量用大写开头的原因,尽量避免命名重叠的情况发生），使用小驼峰命名。
    Lua代码内的控件变量名与蓝图的控件名保持一致，并且蓝图控件名首字母大写, 控件名由控件类型+控件功能组合而成。
    控件命名举例：ButtonClose ,  CheckBoxTab(ToggleTab) ,  TextName ,  ImageIcon ,  ListViewMails。
    蓝图内命名的变量，如果要用在Lua代码内，统一使用前缀“bp”，使用小驼峰命名法。
    
        
    常量命名
    Lua里没有严格的常数定义标识符，所以对于常数的命名格外重要。
    常数一般采用大下划线命名法。这样每个字母都大写，十分醒目，且各个单词都用下划线分割，便于阅读。
    比如：MAX_SPEED = 100 表示最大速度，IS_SHOW_DEBUG_ERROR_MSG表示是否显示报错消息等等。
    局部常量定义在各lua文件表头；全局常量定义在Global文件内。
    
    
    枚举命名
    Lua层的枚举名命名，与类名命名一致，并且不要以E开头，不然会从C++层去找，找不到会报错；
    枚举值命名，加前缀e，首字母大写，驼峰命名；
    ControllerViewType = {
        eScene = 0,
        ePanel = 1，
        ePop = 2,
    }
    ```
    
    ``` lua
    注意事项：
    1.供Lua调用的C++类名注意以“A，E，F，S，U”等字母开头，需要再加相同字母的前缀。
    2. 控制全局变量的数量，统一在Global.lua内require。全局变量实际是放入全局表中，每次调用是用传入变量名作为key去获取，而local变量是直接通过lua的堆栈访问的，存取速度更快；所以还推荐当作常量来多次使用的全局变量应该存为局部变量使用。
    
    local playerName = Cache.playerCache.username  --为全局变量再赋值一个局部变量拿来使用
    local function = itemTemplate(data)           
    nameLabel:setText(playerName)
    
    3.不受UIManager管理的类，如需进行button.OnClick，UIEvent， AddNetMessage等的注册，需要自行维护反注册的管理。
    4.同一个Frame支持重复打开，正常调用OpenFrame即可。
    5.字符串拼接少用“..”；由于字符串的管理机制，字符串在使用..连接时，会产生新的对象。由于lua在VM内对相同的string永远只保留一份唯一copy。
    
        local description ＝ ""
        for i = 1,20 do
            description = description.."xxx"
        end
        --这样会生成21份string的copy，但实际上我们只需要最后那一份。如果是轻量级的简单连接还是可以使用的，因为影响不大，但要是大量的类似拼接，推荐使用string.format()。
    
    6. 更快的插入代码
        -- 更慢，不推荐
        table.insert(t, value)
        -- 更快，推荐
        t[#t+1] = value
    
    7. 设法减少从C向lua传递字符串。
    	字符串常量在 Lua VM 内部工作的非常快，但是一个从 C 向 lua vm 通过 lua_pushstring 之类的 api 传递进 VM 时，至少包含一个再 hash 和匹配的过程。
    ```
    
    
  
  



---



### 统一命名

* 语言中的命名规则

  ``` text
  自定义类名、结构名： 大驼峰（Pascal） CamelCase
  
  文件名：大驼峰 CamelCase.h  CSharpClass.cs  JavaClass.java					=>  前缀 + 大驼峰命名法 如：CLAvalonDefine.h
  																	前缀一般按工程指定，如CommonLib==>CL  Avalon==Avalon
  
  命名空间：大驼峰 (公司名.项目名.模块名.细分模块名...)   Tenmove.Runtime.Client.Unity
  
  函数名：
  （静态）公有：大驼峰   GetA()  /  static T GetA()
  （静态）私有、保护： 小驼峰（Camel）    static T getA();
  （非静态）保护： 小驼峰  getA()
  （非静态）私有： _ + 小驼峰    _getA();									  =>  私有函数特殊公司要求：大驼峰？！
  
  单元测试方法：全小写，单词间用_分割 (snake_case)   should_get_200_status_code_when_request_is_valid（）
  测试类：以Test结尾   class AnnotationUtilsTest {}
  
  (匈牙利命名法，已成历史，有硬编码的问题，不建议使用，但是下列几个能更清晰的标识范围)
  类成员变量（私有）：  m_ + 小驼峰	int m_point;  int m_startPoint;			 =>  部分使用m+大驼峰，如C#、Java, 或特殊公司要求
  全局成员变量： g_ + 小驼峰    int g_point;
  静态成员变量（私有）： ms_ + 小驼峰    int ms_point;
  
  一组变量    小驼峰_序号     int int_0 = 0;
  
  类成员变量（公有、保护）： 小驼峰   int point;
  
  静态成员变量（公有、保护）：大驼峰  int Point
  
  结构体成员变量： 小驼峰       int point;									=> 因为结构体成员一般为public
  方法内的局部变量： 小驼峰 / 全小写+_      int point;    auto mid_iter; 
  
  bool成员变量： bFlag、BFlag、m_bFlag
  
  类（接口，结构体） 属性：
  公有：     大驼峰
  保护、私有：小驼峰
  
  C++别名（using）: 全小写 + _
  
  枚举类型： 大驼峰    enum TestStatus {}
  枚举值：  大驼峰 (易读，用_分割)  				//全大写， 用_分割 TEST_STATUS_DEFAULT; 尽量不要简写，如：TS_xxx，应该：TaskStatus_xx
  
  宏：全大写，用_分割    #define TEST_FUNC
  
  常量Const: 
  公有：全大写，用_分割 			//不需要大驼峰 （易读 不需要和宏做区分） 
  保护、私有： k + 大驼峰
  
  接口： I前缀 + 大驼峰
  
  
  ```
  
  



* 项目工程中的命名

  ``` text
  尽可能使用描述性的命名，不用在意名字太长，除了一些特定的广为人知的缩写，都不要使用缩写。实在没有适合的英文单词时看一看使用拼音。
  
  文件命名，各工程推荐使用一致的前缀，Avalon和CommonLib前缀指定前缀（分别为Avalon和CL）
  
  项目文件夹名称：串式命名(kebab-case)    tmsdk-platform
  ```

  

* 注释

  ``` text
  块注释：
  函数注释
  /**
   *@brief 类、函数功能介绍
   *@param 函数参数介绍
   *@return 返回值
   */
  // param和return不是一定要填，如果有需要可以加上
  
  
  类注释
  /**
   *@brief 类功能介绍 
   */
   class PlayerMgr : public Avalon::Singleton<PlayerMgr>
   {
   	 /**
       *@brief 添加一个玩家
       *@param player 玩家对象
       *return 是否成功
       */
      bool AddPlayer(Player* player);
   }
   
   
  行注释:
  其他注释用 //  # 等
  ```



### 一些代码规范

* 括号

  ``` text
  {}括号
  if中代码块不管多简单一定要用大括号包起来，(第一个括号可以同一行)各占一行
  {
  ...
  } //花括号的闭合处可以加上注释
  
  类的括号 另起一行
  类中成员函数括号 另起一行
  成员函数中的括号 同行写
  
  
  ()括号
  一行中有多种操作时每一个小操作都要用括号括起来
  错误：
      d = a & b | c
  正确:
      d = (a & b) | c
   
  错误:
      d = a + c > b ? a + c : b
  正确:
      d = ((a + c) > b) ? (a + c) : b
  ```

  

* ++ / --

  ``` text
  优先使用前++，除非业务必须后++
  ```

