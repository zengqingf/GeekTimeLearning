<!DOCTYPE html><html><head>
      <title>BaseTownLogicLifeCycle</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css">
      
      
      
      <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mermaid@8.5.2/dist/mermaid.min.js"></script>
      
      
      
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.2.7/raphael.min.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/flowchart/1.7.0/flowchart.min.js"></script>
      
      <style>
      /**
 * prism.js Github theme based on GitHub's theme.
 * @author Sam Clarke
 */
code[class*="language-"],
pre[class*="language-"] {
  color: #333;
  background: none;
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.4;

  -moz-tab-size: 8;
  -o-tab-size: 8;
  tab-size: 8;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
  padding: .8em;
  overflow: auto;
  /* border: 1px solid #ddd; */
  border-radius: 3px;
  /* background: #fff; */
  background: #f5f5f5;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
  padding: .1em;
  border-radius: .3em;
  white-space: normal;
  background: #f5f5f5;
}

.token.comment,
.token.blockquote {
  color: #969896;
}

.token.cdata {
  color: #183691;
}

.token.doctype,
.token.punctuation,
.token.variable,
.token.macro.property {
  color: #333;
}

.token.operator,
.token.important,
.token.keyword,
.token.rule,
.token.builtin {
  color: #a71d5d;
}

.token.string,
.token.url,
.token.regex,
.token.attr-value {
  color: #183691;
}

.token.property,
.token.number,
.token.boolean,
.token.entity,
.token.atrule,
.token.constant,
.token.symbol,
.token.command,
.token.code {
  color: #0086b3;
}

.token.tag,
.token.selector,
.token.prolog {
  color: #63a35c;
}

.token.function,
.token.namespace,
.token.pseudo-element,
.token.class,
.token.class-name,
.token.pseudo-class,
.token.id,
.token.url-reference .token.variable,
.token.attr-name {
  color: #795da3;
}

.token.entity {
  cursor: help;
}

.token.title,
.token.title .token.punctuation {
  font-weight: bold;
  color: #1d3e81;
}

.token.list {
  color: #ed6a43;
}

.token.inserted {
  background-color: #eaffea;
  color: #55a532;
}

.token.deleted {
  background-color: #ffecec;
  color: #bd2c00;
}

.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}


/* JSON */
.language-json .token.property {
  color: #183691;
}

.language-markup .token.tag .token.punctuation {
  color: #333;
}

/* CSS */
code.language-css,
.language-css .token.function {
  color: #0086b3;
}

/* YAML */
.language-yaml .token.atrule {
  color: #63a35c;
}

code.language-yaml {
  color: #183691;
}

/* Ruby */
.language-ruby .token.function {
  color: #333;
}

/* Markdown */
.language-markdown .token.url {
  color: #795da3;
}

/* Makefile */
.language-makefile .token.symbol {
  color: #795da3;
}

.language-makefile .token.variable {
  color: #183691;
}

.language-makefile .token.builtin {
  color: #0086b3;
}

/* Bash */
.language-bash .token.keyword {
  color: #0086b3;
}

/* highlight */
pre[data-line] {
  position: relative;
  padding: 1em 0 1em 3em;
}
pre[data-line] .line-highlight-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  background-color: transparent;
  display: block;
  width: 100%;
}

pre[data-line] .line-highlight {
  position: absolute;
  left: 0;
  right: 0;
  padding: inherit 0;
  margin-top: 1em;
  background: hsla(24, 20%, 50%,.08);
  background: linear-gradient(to right, hsla(24, 20%, 50%,.1) 70%, hsla(24, 20%, 50%,0));
  pointer-events: none;
  line-height: inherit;
  white-space: pre;
}

pre[data-line] .line-highlight:before, 
pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-start);
  position: absolute;
  top: .4em;
  left: .6em;
  min-width: 1em;
  padding: 0 .5em;
  background-color: hsla(24, 20%, 50%,.4);
  color: hsl(24, 20%, 95%);
  font: bold 65%/1.5 sans-serif;
  text-align: center;
  vertical-align: .3em;
  border-radius: 999px;
  text-shadow: none;
  box-shadow: 0 1px white;
}

pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-end);
  top: auto;
  bottom: .4em;
}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ul,html body>ol{margin-bottom:16px}html body ul,html body ol{padding-left:2em}html body ul.no-list,html body ol.no-list{padding:0;list-style-type:none}html body ul ul,html body ul ol,html body ol ol,html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:bold;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:bold}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em !important;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::before,html body code::after{letter-spacing:-0.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em !important;word-break:normal;white-space:pre;background:transparent;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em !important;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:before,html body pre tt:before,html body pre code:after,html body pre tt:after{content:normal}html body p,html body blockquote,html body ul,html body ol,html body dl,html body pre{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body pre,html body code{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .pagebreak,.markdown-preview .newpage{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center !important}.markdown-preview:not([for="preview"]) .code-chunk .btn-group{display:none}.markdown-preview:not([for="preview"]) .code-chunk .status{display:none}.markdown-preview:not([for="preview"]) .code-chunk .output-div{margin-bottom:16px}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0}@media screen and (min-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{font-size:14px !important;padding:1em}}@media print{html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,0.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{padding:0 1.6em;margin-top:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc li{margin-bottom:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{list-style-type:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% -  300px);padding:2em calc(50% - 457px -  150px);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
    </head>
    <body for="html-export">
      <div class="mume markdown-preview  ">
      <h1 class="mume-header" id="%E5%9F%8E%E9%95%87%E9%80%BB%E8%BE%91%E6%89%A9%E5%B1%95">&#x57CE;&#x9547;&#x903B;&#x8F91;&#x6269;&#x5C55;</h1>

<h2 class="mume-header" id="%E7%B3%BB%E7%BB%9F%E5%88%87%E6%8D%A2">&#x7CFB;&#x7EDF;&#x5207;&#x6362;</h2>

<ol>
<li>&#x521B;&#x5EFA; Init
<ul>
<li>Login  -&gt; Town</li>
<li>Battle -&gt; Town</li>
</ul>
</li>
<li>&#x9500;&#x6BC1; UnInit
<ul>
<li>Town   -&gt; Login</li>
<li>Town   -&gt; Battle</li>
</ul>
</li>
<li>&#x5207;&#x6362; Swtich
<ul>
<li>Town   -&gt; Town</li>
</ul>
</li>
</ol>
<h3 class="mume-header" id="%E4%BB%A3%E7%A0%81">&#x4EE3;&#x7801;</h3>

<pre data-role="codeBlock" data-info="csharp" class="language-csharp"><span class="token keyword">protected</span> <span class="token class-name">IEnumerator</span> <span class="token function">TownLoadingCoroutine</span><span class="token punctuation">(</span><span class="token class-name">IASyncOperation</span> systemOperation<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// &#x6B64;&#x5904;&#x7565;&#x53BB;&#x4E00;&#x4E9B;&#x4EE3;&#x7801;</span>

    ClientSystemManager<span class="token punctuation">.</span>instance<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">OpenFrame</span><span class="token punctuation">&lt;</span><span class="token class-name">ClientSystemTownFrame</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>FrameLayer<span class="token punctuation">.</span>Bottom<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// &#x6B64;&#x5904;&#x7565;&#x53BB;&#x4E00;&#x4E9B;&#x4EE3;&#x7801;</span>

    <span class="token punctuation">{</span>
        <span class="token comment">// &#x6B64;&#x5904;&#x7565;&#x53BB;&#x4E00;&#x4E9B;&#x4EE3;&#x7801;</span>

        <span class="token class-name">Type</span> systemType <span class="token operator">=</span> SystemManager<span class="token punctuation">.</span>CurrentSystem<span class="token punctuation">.</span><span class="token function">GetType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>systemType <span class="token operator">==</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span>ClientSystemLogin<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">yield</span> <span class="token keyword">return</span> <span class="token function">_SystemInitEnterGame</span><span class="token punctuation">(</span>systemOperation<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>systemType <span class="token operator">==</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span>ClientSystemBattle<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">yield</span> <span class="token keyword">return</span> <span class="token function">_SystemInitReturnToTown</span><span class="token punctuation">(</span>systemOperation<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>systemType <span class="token operator">==</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span>ClientSystemGameBattle<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">// &#x6B64;&#x5904;&#x7565;&#x53BB;&#x4E00;&#x4E9B;&#x4EE3;&#x7801;</span>

            <span class="token keyword">yield</span> <span class="token keyword">return</span> <span class="token function">_SystemInitReturnToTown</span><span class="token punctuation">(</span>systemOperation<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// &#x6B64;&#x5904;&#x7565;&#x53BB;&#x4E00;&#x4E9B;&#x4EE3;&#x7801;</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token class-name">IEnumerator</span> <span class="token function">_systemInitEnterGameProcess</span><span class="token punctuation">(</span><span class="token class-name">IASyncOperation</span> systemOperation<span class="token punctuation">,</span> <span class="token keyword">bool</span> initwithNewbieGuideBattle <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// &#x6B64;&#x5904;&#x7565;&#x53BB;&#x4E00;&#x4E9B;&#x4EE3;&#x7801;</span>
    PlayerDataManager<span class="token punctuation">.</span><span class="token function">GetInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">InitiallizeSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">GateEnterGameReq</span> enterGame <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GateEnterGameReq</span>
    <span class="token punctuation">{</span>
        roleId <span class="token operator">=</span> ClientApplication<span class="token punctuation">.</span>playerinfo<span class="token punctuation">.</span><span class="token function">GetSelectRoleBaseInfoByLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>roleId<span class="token punctuation">,</span>
        city <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        inviter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
        option <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token class-name">NetManager</span> netMgr <span class="token operator">=</span> NetManager<span class="token punctuation">.</span><span class="token function">Instance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    netMgr<span class="token punctuation">.</span><span class="token function">SendCommand</span><span class="token punctuation">(</span>ServerType<span class="token punctuation">.</span>GATE_SERVER<span class="token punctuation">,</span> enterGame<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 0:&#x975E;&#x6CD5; 1:&#x8D85;&#x65F6; 2:&#x767B;&#x5F55;&#x7ED3;&#x679C;&#x9519;&#x8BEF; 3:&#x6B63;&#x5E38;</span>
    <span class="token class-name">EEnterGameState</span> eEnterState <span class="token operator">=</span> EEnterGameState<span class="token punctuation">.</span>Invalid<span class="token punctuation">;</span>
    <span class="token class-name">WaitNetMessageManager<span class="token punctuation">.</span>NetMessages</span> netMsgs <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

    List<span class="token operator">&lt;</span><span class="token keyword">uint</span><span class="token operator">&gt;</span> arrWaitMsgIDs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">List</span><span class="token operator">&lt;</span><span class="token keyword">uint</span><span class="token operator">&gt;</span>
    <span class="token punctuation">{</span>
        SceneNotifyEnterScene<span class="token punctuation">.</span>MsgID<span class="token punctuation">,</span>
        SceneSyncSceneObject<span class="token punctuation">.</span>MsgID<span class="token punctuation">,</span>
        GateEnterGameRet<span class="token punctuation">.</span>MsgID
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    arrWaitMsgIDs<span class="token punctuation">.</span><span class="token function">AddRange</span><span class="token punctuation">(</span>EEnterGameWaitMsg<span class="token punctuation">.</span>msgs<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">WaitNetMessageManager<span class="token punctuation">.</span>WaitMulti</span> wait <span class="token operator">=</span> WaitNetMessageManager<span class="token punctuation">.</span><span class="token function">GetInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span>arrWaitMsgIDs<span class="token punctuation">.</span><span class="token function">ToArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> msgRets <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">true</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// &#x6B64;&#x5904;&#x7565;&#x53BB;&#x4E00;&#x4E9B;&#x4EE3;&#x7801;</span>


    <span class="token class-name">SceneNotifyEnterScene</span> msgEnterScene <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SceneNotifyEnterScene</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    msgEnterScene<span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>netMsgs<span class="token punctuation">.</span><span class="token function">GetMessageData</span><span class="token punctuation">(</span>SceneNotifyEnterScene<span class="token punctuation">.</span>MsgID<span class="token punctuation">)</span><span class="token punctuation">.</span>bytes<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// &#x6B64;&#x5904;&#x7565;&#x53BB;&#x4E00;&#x4E9B;&#x4EE3;&#x7801;</span>

    <span class="token class-name">TownEnterParam</span> townEnterParam <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TownEnterParam</span><span class="token punctuation">(</span>msgEnterScene<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> mapID <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>townEnterParam<span class="token punctuation">.</span>ID<span class="token punctuation">;</span>

    PlayerBaseData<span class="token punctuation">.</span><span class="token function">GetInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Pos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vector3</span><span class="token punctuation">(</span>
            townEnterParam<span class="token punctuation">.</span>PosX <span class="token operator">/</span> PlayerBaseData<span class="token punctuation">.</span><span class="token function">GetInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>AxisScale<span class="token punctuation">,</span>
            <span class="token number">0.0f</span><span class="token punctuation">,</span>
            townEnterParam<span class="token punctuation">.</span>PosY <span class="token operator">/</span> PlayerBaseData<span class="token punctuation">.</span><span class="token function">GetInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>AxisScale
        <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">_InitOtherPlayerData</span><span class="token punctuation">(</span>netMsgs<span class="token punctuation">.</span><span class="token function">GetMessageData</span><span class="token punctuation">(</span>SceneSyncSceneObject<span class="token punctuation">.</span>MsgID<span class="token punctuation">)</span><span class="token punctuation">,</span> townEnterParam<span class="token punctuation">.</span>ID<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">InitializeScene</span><span class="token punctuation">(</span>mapID<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// &#x6B64;&#x5904;&#x7565;&#x53BB;&#x4E00;&#x4E9B;&#x4EE3;&#x7801;</span>
<span class="token punctuation">}</span>


<span class="token keyword">protected</span> <span class="token class-name">IEnumerator</span> <span class="token function">_SystemInitReturnToTown</span><span class="token punctuation">(</span><span class="token class-name">IASyncOperation</span> systemOperation<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// &#x6B64;&#x5904;&#x7565;&#x53BB;&#x4E00;&#x4E9B;&#x4EE3;&#x7801;</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>Global<span class="token punctuation">.</span>Settings<span class="token punctuation">.</span>isGuide <span class="token operator">&amp;&amp;</span> BattleMain<span class="token punctuation">.</span><span class="token function">IsLastNewbieGuideBattle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">// &quot;&#x7531;&#x65B0;&#x624B;&#x5F15;&#x5BFC;&#x7B2C;&#x4E00;&#x573A;&#x6218;&#x6597;&#x8FD4;&#x56DE;&quot;</span>
            <span class="token keyword">yield</span> <span class="token keyword">return</span> <span class="token function">_SystemInitEnterGame</span><span class="token punctuation">(</span>systemOperation<span class="token punctuation">,</span> <span class="token keyword">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ReplayServer<span class="token punctuation">.</span><span class="token function">GetInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">IsLastPlaying</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">// &quot;&#x7531;&#x6218;&#x6597;&#x5F55;&#x50CF;&#x8FD4;&#x56DE;&quot;</span>
            <span class="token function">InitializeScene</span><span class="token punctuation">(</span>_lastSceneId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>BattleMain<span class="token punctuation">.</span><span class="token function">CheckLastBattleMode</span><span class="token punctuation">(</span>BattleType<span class="token punctuation">.</span>Training<span class="token punctuation">)</span> <span class="token operator">||</span> BattleMain<span class="token punctuation">.</span><span class="token function">CheckLastBattleMode</span><span class="token punctuation">(</span>BattleType<span class="token punctuation">.</span>TrainingPVE<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">// &quot;&#x7531;&#x6218;&#x6597;&#x5F55;&#x50CF;&#x8FD4;&#x56DE;&quot;</span>
            <span class="token function">InitializeScene</span><span class="token punctuation">(</span>_lastSceneId<span class="token punctuation">)</span><span class="token punctuation">;</span>
            BattleMain<span class="token punctuation">.</span>battleType <span class="token operator">=</span> BattleType<span class="token punctuation">.</span>Single<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">{</span>

            <span class="token comment">// &#x7531;&#x666E;&#x901A;&#x6218;&#x6597;&#x8FD4;&#x56DE;</span>
            <span class="token class-name">SceneReturnToTown</span> returnScene <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SceneReturnToTown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// &#x6B64;&#x5904;&#x7565;&#x53BB;&#x4E00;&#x4E9B;&#x4EE3;&#x7801;</span>

            <span class="token keyword">yield</span> <span class="token keyword">return</span> MessageUtility<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">WaitWithResend</span><span class="token punctuation">&lt;</span><span class="token class-name">SceneReturnToTown</span><span class="token punctuation">,</span> <span class="token class-name">SceneNotifyEnterScene</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>ServerType<span class="token punctuation">.</span>GATE_SERVER<span class="token punctuation">,</span> msgEvents<span class="token punctuation">,</span> returnScene<span class="token punctuation">,</span> msgEnterScene<span class="token punctuation">,</span> <span class="token keyword">true</span><span class="token punctuation">,</span> <span class="token number">8.0f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// &#x6B64;&#x5904;&#x7565;&#x53BB;&#x4E00;&#x4E9B;&#x4EE3;&#x7801;</span>
            currentSceneID <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>msgEnterScene<span class="token punctuation">.</span>mapid<span class="token punctuation">;</span>

            PlayerBaseData<span class="token punctuation">.</span><span class="token function">GetInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Pos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vector3</span><span class="token punctuation">(</span>msgEnterScene<span class="token punctuation">.</span>pos<span class="token punctuation">.</span>x <span class="token operator">/</span> PlayerBaseData<span class="token punctuation">.</span><span class="token function">GetInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>AxisScale<span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span> msgEnterScene<span class="token punctuation">.</span>pos<span class="token punctuation">.</span>y <span class="token operator">/</span> PlayerBaseData<span class="token punctuation">.</span><span class="token function">GetInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>AxisScale<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">_InitOtherPlayerData</span><span class="token punctuation">(</span>msgEvents<span class="token punctuation">.</span><span class="token function">GetMessageData</span><span class="token punctuation">(</span>SceneSyncSceneObject<span class="token punctuation">.</span>MsgID<span class="token punctuation">)</span><span class="token punctuation">,</span> msgEnterScene<span class="token punctuation">.</span>mapid<span class="token punctuation">)</span><span class="token punctuation">;</span> 

            <span class="token keyword">yield</span> <span class="token keyword">return</span> Yielders<span class="token punctuation">.</span>EndOfFrame<span class="token punctuation">;</span>

            <span class="token function">InitializeScene</span><span class="token punctuation">(</span>currentSceneID<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// &#x6B64;&#x5904;&#x7565;&#x53BB;&#x4E00;&#x4E9B;&#x4EE3;&#x7801;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><h2 class="mume-header" id="%E5%85%B3%E7%B3%BB%E5%9B%BE">&#x5173;&#x7CFB;&#x56FE;</h2>

<div class="mermaid">graph LR
    ClientSystemLogin  -- &#x767B;&#x9646; _SystemInitEnterGame --&gt; ClientSystemTown 
    ClientSystemLogin  -- &#x7B2C;&#x4E00;&#x573A;&#x6218;&#x6597;&#x65B0;&#x624B;&#x6218;&#x6597; --&gt; ClientSystemBattle 
    ClientSystemTown   -- &#x8FDB;&#x5165;&#x6218;&#x6597; --&gt; ClientSystemBattle 
    ClientSystemTown   -- &#x57CE;&#x9547;&#x4E4B;&#x95F4;&#x5207;&#x6362; --&gt; ClientSystemTown 
    ClientSystemBattle -- &#x4ECE;&#x666E;&#x901A;&#x6218;&#x6597;&#x961F;&#x7B49;&#x8FD4;&#x56DE; --&gt; ClientSystemTown 
    ClientSystemBattle -- &#x4ECE;&#x5F55;&#x50CF;&#x8FD4;&#x56DE; --&gt; ClientSystemTown 
    ClientSystemBattle -- &#x4ECE;&#x7EC3;&#x4E60;&#x573A;&#x8FD4;&#x56DE; --&gt; ClientSystemTown 

    ClientSystemTown   -- &#x9000;&#x51FA;&#x5230;&#x767B;&#x9646; --&gt; ClientSystemLogin 

    ClientSystemTown   -- &#x65AD;&#x7EBF;&#x7B49;&#x60C5;&#x51B5;&#x8FD4;&#x56DE;&#x767B;&#x9646; --&gt; ClientSystemLogin 
    ClientSystemBattle -- &#x65AD;&#x7EBF;&#x7B49;&#x60C5;&#x51B5;&#x8FD4;&#x56DE;&#x767B;&#x9646; --&gt;  ClientSystemLogin 
</div><h2 class="mume-header" id="town-init-uninit-%E6%97%B6%E5%BA%8F">Town Init &amp; UnInit &#x65F6;&#x5E8F;</h2>

<p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" contentscripttype="application/ecmascript" contentstyletype="text/css" height="1133px" preserveAspectRatio="none" style="width:836px;height:1133px;" version="1.1" viewBox="0 0 836 1133" width="836px" zoomAndPan="magnify"><defs><filter height="300%" id="fa90tx3hdii66" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="117" x="355" y="28.6855">Town&#x76F8;&#x5173;&#x65F6;&#x5E8F;</text><rect fill="#FFFFFF" filter="url(#fa90tx3hdii66)" height="60.7031" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="63.5" y="505.6016"/><rect fill="#FFFFFF" filter="url(#fa90tx3hdii66)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="310" y="152.9531"/><rect fill="#FFFFFF" filter="url(#fa90tx3hdii66)" height="36.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="310" y="273.6563"/><rect fill="#FFFFFF" filter="url(#fa90tx3hdii66)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="424" y="213.3047"/><rect fill="#FFFFFF" filter="url(#fa90tx3hdii66)" height="68.7031" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="424" y="347.3594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="424" x2="424" y1="347.3594" y2="416.0625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="434" x2="434" y1="347.3594" y2="416.0625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="424" x2="434" y1="347.3594" y2="347.3594"/><rect fill="#FFFFFF" filter="url(#fa90tx3hdii66)" height="261.8125" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="424" y="457.8984"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="424" x2="424" y1="457.8984" y2="719.7109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="434" x2="434" y1="457.8984" y2="719.7109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="424" x2="434" y1="719.7109" y2="719.7109"/><rect fill="#FFFFFF" filter="url(#fa90tx3hdii66)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="424" y="909.4375"/><rect fill="#FFFFFF" filter="url(#fa90tx3hdii66)" height="36.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="424" y="1030.1406"/><rect fill="#FFFFFF" filter="url(#fa90tx3hdii66)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="580" y="969.7891"/><rect fill="#FFFFFF" filter="url(#fa90tx3hdii66)" height="329.8125" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="705" y="86.25"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="705" x2="705" y1="86.25" y2="416.0625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="715" x2="715" y1="86.25" y2="416.0625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="705" x2="715" y1="86.25" y2="86.25"/><rect fill="#FFFFFF" filter="url(#fa90tx3hdii66)" height="343" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="705" y="457.8984"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="705" x2="705" y1="457.8984" y2="800.8984"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="715" x2="715" y1="457.8984" y2="800.8984"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="705" x2="715" y1="800.8984" y2="800.8984"/><rect fill="#FFFFFF" filter="url(#fa90tx3hdii66)" height="329" style="stroke: #000000; stroke-width: 2.0;" width="801" x="13" y="464.8984"/><rect fill="#FFFFFF" height="59.1875" style="stroke: none; stroke-width: 1.0;" width="801" x="13" y="734.7109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="68" x2="68" y1="76.25" y2="416.0625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="68" x2="68" y1="416.0625" y2="457.8984"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="68" x2="68" y1="457.8984" y2="845.25"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="68" x2="68" y1="845.25" y2="887.0859"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="68" x2="68" y1="887.0859" y2="1091.4922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="196" x2="196" y1="76.25" y2="416.0625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="196" x2="196" y1="416.0625" y2="457.8984"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="196" x2="196" y1="457.8984" y2="845.25"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="196" x2="196" y1="845.25" y2="887.0859"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="196" x2="196" y1="887.0859" y2="1091.4922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="315" x2="315" y1="76.25" y2="416.0625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="315" x2="315" y1="416.0625" y2="457.8984"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="315" x2="315" y1="457.8984" y2="845.25"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="315" x2="315" y1="845.25" y2="887.0859"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="315" x2="315" y1="887.0859" y2="1091.4922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="429" x2="429" y1="76.25" y2="416.0625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="429" x2="429" y1="416.0625" y2="457.8984"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="429" x2="429" y1="457.8984" y2="845.25"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="429" x2="429" y1="845.25" y2="887.0859"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="429" x2="429" y1="887.0859" y2="1091.4922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="585" x2="585" y1="76.25" y2="416.0625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="585" x2="585" y1="416.0625" y2="457.8984"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="585" x2="585" y1="457.8984" y2="845.25"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="585" x2="585" y1="845.25" y2="887.0859"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="585" x2="585" y1="887.0859" y2="1091.4922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="710" x2="710" y1="76.25" y2="416.0625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="710" x2="710" y1="416.0625" y2="457.8984"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="710" x2="710" y1="457.8984" y2="845.25"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="710" x2="710" y1="845.25" y2="887.0859"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="710" x2="710" y1="887.0859" y2="1091.4922"/><rect fill="#FEFECE" filter="url(#fa90tx3hdii66)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="87" x="23" y="39.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="30" y="61.1738">GateServer</text><rect fill="#FEFECE" filter="url(#fa90tx3hdii66)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="87" x="23" y="1090.4922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="30" y="1112.0254">GateServer</text><rect fill="#FEFECE" filter="url(#fa90tx3hdii66)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="140" x="124" y="39.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="126" x="131" y="61.1738">PlayerDataManager</text><rect fill="#FEFECE" filter="url(#fa90tx3hdii66)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="140" x="124" y="1090.4922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="126" x="131" y="1112.0254">PlayerDataManager</text><rect fill="#FEFECE" filter="url(#fa90tx3hdii66)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="70" x="278" y="39.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="285" y="61.1738">&#x4E0A;&#x4E2A;&#x7CFB;&#x7EDF;</text><rect fill="#FEFECE" filter="url(#fa90tx3hdii66)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="70" x="278" y="1090.4922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="285" y="1112.0254">&#x4E0A;&#x4E2A;&#x7CFB;&#x7EDF;</text><rect fill="#FEFECE" filter="url(#fa90tx3hdii66)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="130" x="362" y="39.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="116" x="369" y="61.1738">ClientSystemTown</text><rect fill="#FEFECE" filter="url(#fa90tx3hdii66)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="130" x="362" y="1090.4922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="116" x="369" y="1112.0254">ClientSystemTown</text><rect fill="#FEFECE" filter="url(#fa90tx3hdii66)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="70" x="548" y="39.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="555" y="61.1738">&#x4E0B;&#x4E2A;&#x7CFB;&#x7EDF;</text><rect fill="#FEFECE" filter="url(#fa90tx3hdii66)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="70" x="548" y="1090.4922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="555" y="1112.0254">&#x4E0B;&#x4E2A;&#x7CFB;&#x7EDF;</text><rect fill="#FEFECE" filter="url(#fa90tx3hdii66)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="152" x="632" y="39.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="138" x="639" y="61.1738">ClientSystemManager</text><rect fill="#FEFECE" filter="url(#fa90tx3hdii66)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="152" x="632" y="1090.4922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="138" x="639" y="1112.0254">ClientSystemManager</text><rect fill="#FFFFFF" filter="url(#fa90tx3hdii66)" height="60.7031" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="63.5" y="505.6016"/><rect fill="#FFFFFF" filter="url(#fa90tx3hdii66)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="310" y="152.9531"/><rect fill="#FFFFFF" filter="url(#fa90tx3hdii66)" height="36.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="310" y="273.6563"/><rect fill="#FFFFFF" filter="url(#fa90tx3hdii66)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="424" y="213.3047"/><rect fill="#FFFFFF" filter="url(#fa90tx3hdii66)" height="68.7031" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="424" y="347.3594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="424" x2="424" y1="347.3594" y2="416.0625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="434" x2="434" y1="347.3594" y2="416.0625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="424" x2="434" y1="347.3594" y2="347.3594"/><rect fill="#FFFFFF" filter="url(#fa90tx3hdii66)" height="261.8125" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="424" y="457.8984"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="424" x2="424" y1="457.8984" y2="719.7109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="434" x2="434" y1="457.8984" y2="719.7109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="424" x2="434" y1="719.7109" y2="719.7109"/><rect fill="#FFFFFF" filter="url(#fa90tx3hdii66)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="424" y="909.4375"/><rect fill="#FFFFFF" filter="url(#fa90tx3hdii66)" height="36.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="424" y="1030.1406"/><rect fill="#FFFFFF" filter="url(#fa90tx3hdii66)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="580" y="969.7891"/><rect fill="#FFFFFF" filter="url(#fa90tx3hdii66)" height="329.8125" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="705" y="86.25"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="705" x2="705" y1="86.25" y2="416.0625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="715" x2="715" y1="86.25" y2="416.0625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="705" x2="715" y1="86.25" y2="86.25"/><rect fill="#FFFFFF" filter="url(#fa90tx3hdii66)" height="343" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="705" y="457.8984"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="705" x2="705" y1="457.8984" y2="800.8984"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="715" x2="715" y1="457.8984" y2="800.8984"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="705" x2="715" y1="800.8984" y2="800.8984"/><rect fill="#EEEEEE" filter="url(#fa90tx3hdii66)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="821" x="3" y="107.4258"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="824" y1="107.4258" y2="107.4258"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="824" y1="110.4258" y2="110.4258"/><rect fill="#EEEEEE" filter="url(#fa90tx3hdii66)" height="24.3516" style="stroke: #000000; stroke-width: 2.0;" width="38" x="394.5" y="96.25"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="20" x="400.5" y="113.7451">Init</text><polygon fill="#A80036" points="331,148.9531,321,152.9531,331,156.9531,327,152.9531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="325" x2="704" y1="152.9531" y2="152.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="337" y="148.0967">&#x6536;&#x96C6;Exit</text><polygon fill="#A80036" points="445,209.3047,435,213.3047,445,217.3047,441,213.3047" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="439" x2="704" y1="213.3047" y2="213.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="57" x="451" y="208.4482">&#x6536;&#x96C6;Enter</text><polygon fill="#A80036" points="331,269.6563,321,273.6563,331,277.6563,327,273.6563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="325" x2="704" y1="273.6563" y2="273.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="337" y="268.7998">&#x6267;&#x884C; Exit &#x534F;&#x7A0B;</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="320" x2="362" y1="309.0078" y2="309.0078"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="362" x2="362" y1="309.0078" y2="322.0078"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="315" x2="362" y1="322.0078" y2="322.0078"/><polygon fill="#A80036" points="325,318.0078,315,322.0078,325,326.0078,321,322.0078" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="40" x="327" y="304.1514">OnExit</text><polygon fill="#A80036" points="445,343.3594,435,347.3594,445,351.3594,441,347.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="439" x2="704" y1="347.3594" y2="347.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="451" y="342.5029">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="462" y="342.5029">&#x6267;&#x884C; Enter &#x534F;&#x7A0B;</text><polygon fill="#A80036" points="207,373.7109,197,377.7109,207,381.7109,203,377.7109" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="201" x2="423" y1="377.7109" y2="377.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="213" y="372.8545">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="224" y="372.8545">BindNetMessage</text><polygon fill="#A80036" points="79.5,404.0625,69.5,408.0625,79.5,412.0625,75.5,408.0625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="73.5" x2="423" y1="408.0625" y2="408.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="85.5" y="403.2061">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="96.5" y="403.2061">GameEnterReq</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="58" x="360.25" y="441.4814">&#x65F6;&#x95F4; &#x8FC7;&#x53BB;&#x4E86;</text><path d="M13,464.8984 L74,464.8984 L74,472.8984 L64,482.8984 L13,482.8984 L13,464.8984 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="329" style="stroke: #000000; stroke-width: 2.0;" width="801" x="13" y="464.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="28" y="479.3936">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="86" x="89" y="478.3174">[&#x6210;&#x529F;: &#x8FD4;&#x56DE;&#x6D88;&#x606F;]</text><polygon fill="#A80036" points="412,501.6016,422,505.6016,412,509.6016,416,505.6016" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="73.5" x2="418" y1="505.6016" y2="505.6016"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="80.5" y="500.7451">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="91.5" y="500.7451">SysNotifyEnterScene</text><polygon fill="#A80036" points="412,531.9531,422,535.9531,412,539.9531,416,535.9531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="73.5" x2="418" y1="535.9531" y2="535.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="80.5" y="531.0967">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="91.5" y="531.0967">NotifyList</text><polygon fill="#A80036" points="412,562.3047,422,566.3047,412,570.3047,416,566.3047" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="68.5" x2="418" y1="566.3047" y2="566.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="75.5" y="561.4482">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="86.5" y="561.4482">GameEnterRes</text><polygon fill="#A80036" points="207,592.6563,197,596.6563,207,600.6563,203,596.6563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="201" x2="423" y1="596.6563" y2="596.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="213" y="591.7998">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="224" y="591.7998">SetNetMesssage</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="434" x2="476" y1="627.0078" y2="627.0078"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="476" x2="476" y1="627.0078" y2="640.0078"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="435" x2="476" y1="640.0078" y2="640.0078"/><polygon fill="#A80036" points="445,636.0078,435,640.0078,445,644.0078,441,640.0078" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="441" y="622.1514">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="121" x="452" y="622.1514">PlayerBaseData.Pos</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="434" x2="476" y1="670.3594" y2="670.3594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="476" x2="476" y1="670.3594" y2="683.3594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="435" x2="476" y1="683.3594" y2="683.3594"/><polygon fill="#A80036" points="445,679.3594,435,683.3594,445,687.3594,441,683.3594" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="441" y="665.5029">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="452" y="665.5029">OtherPlayerDatas</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="434" x2="476" y1="718.7109" y2="718.7109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="476" x2="476" y1="718.7109" y2="731.7109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="429" x2="476" y1="731.7109" y2="731.7109"/><polygon fill="#A80036" points="439,727.7109,429,731.7109,439,735.7109,435,731.7109" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="441" y="713.8545">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="459" y="713.8545">InitScene</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="13" x2="814" y1="735.7109" y2="735.7109"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="158" x="18" y="747.1299">[&#x8D85;&#x65F6;, &#x6D88;&#x606F;&#x672A;&#x6536;&#x5230;&#x7B49;&#x5F02;&#x5E38;&#x60C5;&#x51B5;]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="715" x2="757" y1="772.8984" y2="772.8984"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="757" x2="757" y1="772.8984" y2="785.8984"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="716" x2="757" y1="785.8984" y2="785.8984"/><polygon fill="#A80036" points="726,781.8984,716,785.8984,726,789.8984,722,785.8984" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="722" y="768.042">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="62" x="740" y="768.042">Quit2Login</text><rect fill="#EEEEEE" filter="url(#fa90tx3hdii66)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="821" x="3" y="822.0742"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="824" y1="822.0742" y2="822.0742"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="824" y1="825.0742" y2="825.0742"/><rect fill="#EEEEEE" filter="url(#fa90tx3hdii66)" height="24.3516" style="stroke: #000000; stroke-width: 2.0;" width="55" x="386" y="810.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="37" x="392" y="828.3936">UnInit</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="66" x="356.25" y="870.6689">&#x5F88;&#x957F;&#x65F6;&#x95F4;&#x8FC7;&#x53BB;</text><polygon fill="#A80036" points="445,905.4375,435,909.4375,445,913.4375,441,909.4375" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="439" x2="709" y1="909.4375" y2="909.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="451" y="904.5811">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="469" y="904.5811">&#x6536;&#x96C6;Exit</text><polygon fill="#A80036" points="601,965.7891,591,969.7891,601,973.7891,597,969.7891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="595" x2="709" y1="969.7891" y2="969.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="607" y="964.9326">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="57" x="625" y="964.9326">&#x6536;&#x96C6;Enter</text><polygon fill="#A80036" points="445,1026.1406,435,1030.1406,445,1034.1406,441,1030.1406" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="439" x2="709" y1="1030.1406" y2="1030.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="451" y="1025.2842">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="469" y="1025.2842">&#x6267;&#x884C; Exit &#x534F;&#x7A0B;</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="434" x2="476" y1="1065.4922" y2="1065.4922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="476" x2="476" y1="1065.4922" y2="1078.4922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="429" x2="476" y1="1078.4922" y2="1078.4922"/><polygon fill="#A80036" points="439,1074.4922,429,1078.4922,439,1082.4922,435,1078.4922" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="441" y="1060.6357">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="40" x="459" y="1060.6357">OnExit</text><!--MD5=[7bb500d22b7c9e398cce4056823306a7]
@startuml

participant GateServer order 10
participant PlayerDataManager order 11
participant 上个系统 order 19
participant ClientSystemTown order 20
participant 下个系统 order 30
participant ClientSystemManager order 40


title Town相关时序

control ClientSystemManager

== Init ==

activate ClientSystemManager

ClientSystemManager -> 上个系统 : 收集Exit
activate 上个系统
deactivate 上个系统
ClientSystemManager -> ClientSystemTown: 收集Enter
activate ClientSystemTown
deactivate ClientSystemTown


ClientSystemManager -> 上个系统: 执行 Exit 协程
activate 上个系统
上个系统 -> 上个系统: OnExit

deactivate 上个系统


autonumber 1
ClientSystemManager -> ClientSystemTown: 执行 Enter 协程
activate ClientSystemTown

ClientSystemTown -> PlayerDataManager: BindNetMessage
ClientSystemTown -> GateServer: GameEnterReq
... 时间 过去了 ...

alt 成功: 返回消息
    GateServer -> ClientSystemTown: SysNotifyEnterScene
    activate GateServer
    GateServer -> ClientSystemTown: NotifyList
    GateServer -> ClientSystemTown: GameEnterRes
    deactivate GateServer

    ClientSystemTown -> PlayerDataManager: SetNetMesssage

    ClientSystemTown -> ClientSystemTown: PlayerBaseData.Pos
    ClientSystemTown -> ClientSystemTown: OtherPlayerDatas
    ClientSystemTown -> ClientSystemTown: InitScene

    deactivate ClientSystemTown
else 超时, 消息未收到等异常情况
    ClientSystemManager -> ClientSystemManager: Quit2Login
end


deactivate ClientSystemManager


== UnInit ==


activate ClientSystemManager

... 很长时间过去 ...

ClientSystemManager -> ClientSystemTown : 收集Exit
activate ClientSystemTown
deactivate ClientSystemTown
ClientSystemManager -> 下个系统: 收集Enter
activate 下个系统
deactivate 下个系统


ClientSystemManager -> ClientSystemTown: 执行 Exit 协程
activate ClientSystemTown
ClientSystemTown -> ClientSystemTown: OnExit

deactivate ClientSystemTown



@enduml

PlantUML version 1.2020.10(Sun May 17 17:35:57 CST 2020)
(MIT source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) Client VM
Java Version: 1.8.0_251-b08
Operating System: Windows 10
Default Encoding: UTF-8
Language: zh
Country: CN
--></g></svg></p><h2 class="mume-header" id="town%E5%88%87%E6%8D%A2%E6%97%B6%E5%BA%8F">Town&#x5207;&#x6362;&#x65F6;&#x5E8F;</h2>

<p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" contentscripttype="application/ecmascript" contentstyletype="text/css" height="661px" preserveAspectRatio="none" style="width:563px;height:661px;" version="1.1" viewBox="0 0 563 661" width="563px" zoomAndPan="magnify"><defs><filter height="300%" id="fdr7bne0cwwiq" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="152" x="206.25" y="28.6855">_NetChangeScene</text><rect fill="#FFFFFF" filter="url(#fdr7bne0cwwiq)" height="61.1875" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="63.5" y="294.3594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="63.5" x2="63.5" y1="294.3594" y2="355.5469"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="73.5" x2="73.5" y1="294.3594" y2="355.5469"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="63.5" x2="73.5" y1="294.3594" y2="294.3594"/><rect fill="#FFFFFF" filter="url(#fdr7bne0cwwiq)" height="139.2422" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="63.5" y="397.3828"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="63.5" x2="63.5" y1="397.3828" y2="536.625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="73.5" x2="73.5" y1="397.3828" y2="536.625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="63.5" x2="73.5" y1="536.625" y2="536.625"/><rect fill="#FFFFFF" filter="url(#fdr7bne0cwwiq)" height="115.0547" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="281.5" y="116.6016"/><rect fill="#FFFFFF" filter="url(#fdr7bne0cwwiq)" height="94.8906" style="stroke: #000000; stroke-width: 2.0;" width="350.5" x="13" y="253.6563"/><rect fill="#FFFFFF" height="46.1875" style="stroke: none; stroke-width: 1.0;" width="350.5" x="13" y="302.3594"/><rect fill="#FFFFFF" filter="url(#fdr7bne0cwwiq)" height="125.2422" style="stroke: #000000; stroke-width: 2.0;" width="350.5" x="13" y="404.3828"/><rect fill="#FFFFFF" height="46.1875" style="stroke: none; stroke-width: 1.0;" width="350.5" x="13" y="483.4375"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="68" x2="68" y1="76.25" y2="355.5469"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="68" x2="68" y1="355.5469" y2="397.3828"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="68" x2="68" y1="397.3828" y2="620.3281"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="286.5" x2="286.5" y1="76.25" y2="355.5469"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="286.5" x2="286.5" y1="355.5469" y2="397.3828"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="286.5" x2="286.5" y1="397.3828" y2="620.3281"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="512.5" x2="512.5" y1="76.25" y2="355.5469"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="512.5" x2="512.5" y1="355.5469" y2="397.3828"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="512.5" x2="512.5" y1="397.3828" y2="620.3281"/><rect fill="#FEFECE" filter="url(#fdr7bne0cwwiq)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="87" x="23" y="39.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="30" y="61.1738">GateServer</text><rect fill="#FEFECE" filter="url(#fdr7bne0cwwiq)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="87" x="23" y="619.3281"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="30" y="640.8613">GateServer</text><rect fill="#FEFECE" filter="url(#fdr7bne0cwwiq)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="130" x="219.5" y="39.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="116" x="226.5" y="61.1738">ClientSystemTown</text><rect fill="#FEFECE" filter="url(#fdr7bne0cwwiq)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="130" x="219.5" y="619.3281"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="116" x="226.5" y="640.8613">ClientSystemTown</text><rect fill="#FEFECE" filter="url(#fdr7bne0cwwiq)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="84" x="468.5" y="39.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="475.5" y="61.1738">MainPlayer</text><rect fill="#FEFECE" filter="url(#fdr7bne0cwwiq)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="84" x="468.5" y="619.3281"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="475.5" y="640.8613">MainPlayer</text><rect fill="#FFFFFF" filter="url(#fdr7bne0cwwiq)" height="61.1875" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="63.5" y="294.3594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="63.5" x2="63.5" y1="294.3594" y2="355.5469"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="73.5" x2="73.5" y1="294.3594" y2="355.5469"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="63.5" x2="73.5" y1="294.3594" y2="294.3594"/><rect fill="#FFFFFF" filter="url(#fdr7bne0cwwiq)" height="139.2422" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="63.5" y="397.3828"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="63.5" x2="63.5" y1="397.3828" y2="536.625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="73.5" x2="73.5" y1="397.3828" y2="536.625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="63.5" x2="73.5" y1="536.625" y2="536.625"/><rect fill="#FFFFFF" filter="url(#fdr7bne0cwwiq)" height="115.0547" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="281.5" y="116.6016"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="286.5" x2="333.5" y1="103.6016" y2="103.6016"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="333.5" x2="333.5" y1="103.6016" y2="116.6016"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="292.5" x2="333.5" y1="116.6016" y2="116.6016"/><polygon fill="#A80036" points="302.5,112.6016,292.5,116.6016,302.5,120.6016,298.5,116.6016" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="298.5" y="98.7451">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="309.5" y="98.7451">isswitcing(true)</text><polygon fill="#A80036" points="500.5,147.9531,510.5,151.9531,500.5,155.9531,504.5,151.9531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="291.5" x2="506.5" y1="151.9531" y2="151.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="298.5" y="147.0967">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="309.5" y="147.0967">enable(false)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="291.5" x2="333.5" y1="182.3047" y2="182.3047"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="333.5" x2="333.5" y1="182.3047" y2="195.3047"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="292.5" x2="333.5" y1="195.3047" y2="195.3047"/><polygon fill="#A80036" points="302.5,191.3047,292.5,195.3047,302.5,199.3047,298.5,195.3047" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="298.5" y="177.4482">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="309.5" y="177.4482">_UnbindSceneNetMessage</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="291.5" x2="333.5" y1="230.6563" y2="230.6563"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="333.5" x2="333.5" y1="230.6563" y2="243.6563"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="286.5" x2="333.5" y1="243.6563" y2="243.6563"/><polygon fill="#A80036" points="296.5,239.6563,286.5,243.6563,296.5,247.6563,292.5,243.6563" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="298.5" y="225.7998">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="309.5" y="225.7998">_OnBindExtraSceneNetMessage</text><path d="M13,253.6563 L74,253.6563 L74,261.6563 L64,271.6563 L13,271.6563 L13,253.6563 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="94.8906" style="stroke: #000000; stroke-width: 2.0;" width="350.5" x="13" y="253.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="28" y="268.1514">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="68" x="89" y="267.0752">[&#x4ECE;&#x6218;&#x6597;&#x8FD4;&#x56DE;]</text><polygon fill="#A80036" points="84.5,290.3594,74.5,294.3594,84.5,298.3594,80.5,294.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="78.5" x2="285.5" y1="294.3594" y2="294.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="90.5" y="289.5029">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="101.5" y="289.5029">SceneReturnToTown</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="13" x2="363.5" y1="303.3594" y2="303.3594"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="92" x="18" y="314.7783">[&#x5728;&#x57CE;&#x9547;&#x4E4B;&#x95F4;&#x5207;&#x6362;]</text><polygon fill="#A80036" points="84.5,336.5469,74.5,340.5469,84.5,344.5469,80.5,340.5469" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="78.5" x2="285.5" y1="340.5469" y2="340.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="90.5" y="335.6904">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="178" x="101.5" y="335.6904">ScenePlayerChangeSceneReq</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="58" x="261.5" y="380.9658">&#x65F6;&#x95F4; &#x8FC7;&#x53BB;&#x4E86;</text><path d="M13,404.3828 L74,404.3828 L74,412.3828 L64,422.3828 L13,422.3828 L13,404.3828 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="125.2422" style="stroke: #000000; stroke-width: 2.0;" width="350.5" x="13" y="404.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="28" y="418.8779">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="89" y="417.8018">[&#x6210;&#x529F;]</text><polygon fill="#A80036" points="274.5,441.0859,284.5,445.0859,274.5,449.0859,278.5,445.0859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="73.5" x2="280.5" y1="445.0859" y2="445.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="80.5" y="440.2295">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="91.5" y="440.2295">SysNotifyEnterScene</text><polygon fill="#A80036" points="274.5,471.4375,284.5,475.4375,274.5,479.4375,278.5,475.4375" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="73.5" x2="280.5" y1="475.4375" y2="475.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="80.5" y="470.5811">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="91.5" y="470.5811">NotifyList</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="13" x2="363.5" y1="484.4375" y2="484.4375"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="18" y="495.8564">[&#x5931;&#x8D25;]</text><polygon fill="#A80036" points="274.5,517.625,284.5,521.625,274.5,525.625,278.5,521.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="73.5" x2="280.5" y1="521.625" y2="521.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="80.5" y="516.7686">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="91.5" y="516.7686">&#x5931;&#x8D25;&#xFF0C;&#x8D85;&#x65F6;&#x7B49;&#x9519;&#x8BEF;&#x60C5;&#x51B5;</text><polygon fill="#A80036" points="500.5,554.9766,510.5,558.9766,500.5,562.9766,504.5,558.9766" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="286.5" x2="506.5" y1="558.9766" y2="558.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="293.5" y="554.1201">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="311.5" y="554.1201">enable(true)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="286.5" x2="328.5" y1="594.3281" y2="594.3281"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="328.5" x2="328.5" y1="594.3281" y2="607.3281"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="281.5" x2="328.5" y1="607.3281" y2="607.3281"/><polygon fill="#A80036" points="291.5,603.3281,281.5,607.3281,291.5,611.3281,287.5,607.3281" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="293.5" y="589.4717">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="311.5" y="589.4717">isswitcing(false)</text><!--MD5=[fbd4e489a40c935196d907761e2c62c4]
@startuml

participant GateServer order 10
participant ClientSystemTown order 20
participant MainPlayer order 41


title _NetChangeScene 


autonumber 1

ClientSystemTown -> ClientSystemTown : isswitcing(true)
activate ClientSystemTown
ClientSystemTown -> MainPlayer : enable(false)
ClientSystemTown -> ClientSystemTown : _UnbindSceneNetMessage
ClientSystemTown -> ClientSystemTown : _OnBindExtraSceneNetMessage

deactivate ClientSystemTown
alt 从战斗返回
    ClientSystemTown -> GateServer: SceneReturnToTown
    activate GateServer
else 在城镇之间切换
    ClientSystemTown -> GateServer: ScenePlayerChangeSceneReq
end

... 时间 过去了 ...

alt 成功
    GateServer -> ClientSystemTown: SysNotifyEnterScene
    GateServer -> ClientSystemTown: NotifyList
else 失败
    GateServer -> ClientSystemTown: 失败，超时等错误情况
end
deactivate GateServer


activate ClientSystemTown
ClientSystemTown -> MainPlayer : enable(true)
ClientSystemTown -> ClientSystemTown : isswitcing(false)
deactivate ClientSystemTown


@enduml

PlantUML version 1.2020.10(Sun May 17 17:35:57 CST 2020)
(MIT source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) Client VM
Java Version: 1.8.0_251-b08
Operating System: Windows 10
Default Encoding: UTF-8
Language: zh
Country: CN
--></g></svg></p><h2 class="mume-header" id="basetownlogic-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F">BaseTownLogic &#x751F;&#x547D;&#x5468;&#x671F;</h2>

<div class="flow">s=&gt;start: &#x5F00;&#x59CB;
e=&gt;end: &#x7ED3;&#x675F;
createop=&gt;operation: Create&#x521B;&#x5EFA;
enterop=&gt;operation: Enter&#x521B;&#x5EFA;&#x4E4B;&#x540E;
notifyEnterScene=&gt;operation: OnEventSceneNotifyEnter&#x901A;&#x77E5;&#x8FDB;&#x5165;&#x573A;&#x666F;
notifySceneObjectCreate=&gt;operation: OnSceneObjectCreate&#x901A;&#x77E5;&#x521B;&#x5EFA;&#x7269;&#x4F53;
notifyPostInitScene=&gt;operation: OnPostInitScene&#x573A;&#x666F;&#x52A0;&#x8F7D;&#x4E4B;&#x540E;
longtime=&gt;operation: .... long long time ....
exitop=&gt;operation: Exit&#x9500;&#x6BC1;&#x524D;
destroyop=&gt;operation: Destroy&#x9500;&#x6BC1;

s-&gt;createop-&gt;notifyEnterScene-&gt;notifySceneObjectCreate-&gt;notifyPostInitScene-&gt;enterop-&gt;longtime-&gt;exitop-&gt;destroyop-&gt;e
</div><h2 class="mume-header" id="%E6%96%B0%E7%9A%84-town-init-uninit-%E6%97%B6%E5%BA%8F">&#x65B0;&#x7684; Town Init &amp; UnInit &#x65F6;&#x5E8F;</h2>

<p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" contentscripttype="application/ecmascript" contentstyletype="text/css" height="2283px" preserveAspectRatio="none" style="width:1300px;height:2283px;" version="1.1" viewBox="0 0 1300 2283" width="1300px" zoomAndPan="magnify"><defs><filter height="300%" id="f1mlkp6alvso4b" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="123" x="584" y="28.6855">Town-&#x751F;&#x547D;&#x5468;&#x671F;</text><rect fill="#DDDDDD" height="2231.7344" style="stroke: #A80036; stroke-width: 1.0;" width="99" x="19" y="40.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="42" x="47.5" y="54.1357">&#x670D;&#x52A1;&#x5668;</text><rect fill="#ADD8E6" height="2231.7344" style="stroke: #A80036; stroke-width: 1.0;" width="374" x="274" y="40.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56" x="433" y="54.1357">&#x57CE;&#x9547;&#x903B;&#x8F91;</text><rect fill="#FFFFFF" filter="url(#f1mlkp6alvso4b)" height="121.4063" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="63.5" y="733.0625"/><rect fill="#8FBC8F" filter="url(#f1mlkp6alvso4b)" height="984.6484" style="stroke: #8FBC8F; stroke-width: 1.0;" width="10" x="332" y="793.7656"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="332" x2="332" y1="793.7656" y2="1778.4141"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="342" x2="342" y1="793.7656" y2="1778.4141"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="332" x2="342" y1="793.7656" y2="793.7656"/><rect fill="#8FBC8F" filter="url(#f1mlkp6alvso4b)" height="394.5156" style="stroke: #8FBC8F; stroke-width: 1.0;" width="10" x="332" y="1820.25"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="332" x2="332" y1="1820.25" y2="2214.7656"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="342" x2="342" y1="1820.25" y2="2214.7656"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="332" x2="342" y1="2214.7656" y2="2214.7656"/><rect fill="#ADD8E6" filter="url(#f1mlkp6alvso4b)" height="36.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="585" y="265.0078"/><rect fill="#ADD8E6" filter="url(#f1mlkp6alvso4b)" height="36.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="585" y="531.4688"/><rect fill="#ADD8E6" filter="url(#f1mlkp6alvso4b)" height="36.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="585" y="946.8438"/><rect fill="#ADD8E6" filter="url(#f1mlkp6alvso4b)" height="73.7031" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="585" y="1652.3594"/><rect fill="#ADD8E6" filter="url(#f1mlkp6alvso4b)" height="36.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="585" y="1872.9531"/><rect fill="#ADD8E6" filter="url(#f1mlkp6alvso4b)" height="36.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="585" y="2141.0625"/><rect fill="#FFFFFF" filter="url(#f1mlkp6alvso4b)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="751" y="174.3047"/><rect fill="#FFFFFF" filter="url(#f1mlkp6alvso4b)" height="36.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="751" y="383.0625"/><rect fill="#FFFFFF" filter="url(#f1mlkp6alvso4b)" height="365.5156" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="865" y="303.3594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="865" x2="865" y1="303.3594" y2="668.875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="875" x2="875" y1="303.3594" y2="668.875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="865" x2="875" y1="303.3594" y2="303.3594"/><rect fill="#FFFFFF" filter="url(#f1mlkp6alvso4b)" height="1067.7031" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="865" y="710.7109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="865" x2="865" y1="710.7109" y2="1778.4141"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="875" x2="875" y1="710.7109" y2="1778.4141"/><rect fill="#FFFFFF" filter="url(#f1mlkp6alvso4b)" height="403.5156" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="865" y="1820.25"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="865" x2="865" y1="1820.25" y2="2223.7656"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="875" x2="875" y1="1820.25" y2="2223.7656"/><rect fill="#FFFFFF" filter="url(#f1mlkp6alvso4b)" height="167.7578" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="870" y="501.1172"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="870" x2="870" y1="501.1172" y2="668.875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="880" x2="880" y1="501.1172" y2="668.875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="870" x2="880" y1="501.1172" y2="501.1172"/><rect fill="#FFFFFF" filter="url(#f1mlkp6alvso4b)" height="1015.3516" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="870" y="710.7109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="870" x2="870" y1="710.7109" y2="1726.0625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="880" x2="880" y1="710.7109" y2="1726.0625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="870" x2="880" y1="1726.0625" y2="1726.0625"/><rect fill="#FFFFFF" filter="url(#f1mlkp6alvso4b)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="870" y="1946.6563"/><rect fill="#FFFFFF" filter="url(#f1mlkp6alvso4b)" height="147.4063" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="870" y="2067.3594"/><rect fill="#FFFFFF" filter="url(#f1mlkp6alvso4b)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1044" y="2007.0078"/><rect fill="#FFFFFF" filter="url(#f1mlkp6alvso4b)" height="561.2734" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="1169" y="107.6016"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1169" x2="1169" y1="107.6016" y2="668.875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1179" x2="1179" y1="107.6016" y2="668.875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1169" x2="1179" y1="107.6016" y2="107.6016"/><rect fill="#FFFFFF" filter="url(#f1mlkp6alvso4b)" height="1015.3516" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="1169" y="710.7109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1169" x2="1169" y1="710.7109" y2="1726.0625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1179" x2="1179" y1="710.7109" y2="1726.0625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1169" x2="1179" y1="1726.0625" y2="1726.0625"/><rect fill="#FFFFFF" filter="url(#f1mlkp6alvso4b)" height="451.7266" style="stroke: #000000; stroke-width: 2.0;" width="1265" x="13" y="620.1719"/><rect fill="#FFFFFF" height="15.8359" style="stroke: none; stroke-width: 1.0;" width="1265" x="13" y="892.8203"/><rect fill="#FFFFFF" height="163.2422" style="stroke: none; stroke-width: 1.0;" width="1265" x="13" y="908.6563"/><rect fill="#FFFFFF" filter="url(#f1mlkp6alvso4b)" height="285.6484" style="stroke: #000000; stroke-width: 2.0;" width="781" x="268" y="1233.3047"/><rect fill="#FFFFFF" height="163.2422" style="stroke: none; stroke-width: 1.0;" width="781" x="268" y="1355.7109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="68" x2="68" y1="97.6016" y2="668.875"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="68" x2="68" y1="668.875" y2="710.7109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="68" x2="68" y1="710.7109" y2="1778.4141"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="68" x2="68" y1="1778.4141" y2="1820.25"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="68" x2="68" y1="1820.25" y2="2232.7656"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="196" x2="196" y1="97.6016" y2="668.875"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="196" x2="196" y1="668.875" y2="710.7109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="196" x2="196" y1="710.7109" y2="1778.4141"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="196" x2="196" y1="1778.4141" y2="1820.25"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="196" x2="196" y1="1820.25" y2="2232.7656"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="337" x2="337" y1="97.6016" y2="668.875"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="337" x2="337" y1="668.875" y2="710.7109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="337" x2="337" y1="710.7109" y2="1778.4141"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="337" x2="337" y1="1778.4141" y2="1820.25"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="337" x2="337" y1="1820.25" y2="2232.7656"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="590" x2="590" y1="97.6016" y2="668.875"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="590" x2="590" y1="668.875" y2="710.7109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="590" x2="590" y1="710.7109" y2="1778.4141"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="590" x2="590" y1="1778.4141" y2="1820.25"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="590" x2="590" y1="1820.25" y2="2232.7656"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="756" x2="756" y1="97.6016" y2="668.875"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="756" x2="756" y1="668.875" y2="710.7109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="756" x2="756" y1="710.7109" y2="1778.4141"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="756" x2="756" y1="1778.4141" y2="1820.25"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="756" x2="756" y1="1820.25" y2="2232.7656"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="870" x2="870" y1="97.6016" y2="668.875"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="870" x2="870" y1="668.875" y2="710.7109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="870" x2="870" y1="710.7109" y2="1778.4141"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="870" x2="870" y1="1778.4141" y2="1820.25"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="870" x2="870" y1="1820.25" y2="2232.7656"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1049" x2="1049" y1="97.6016" y2="668.875"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1049" x2="1049" y1="668.875" y2="710.7109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1049" x2="1049" y1="710.7109" y2="1778.4141"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1049" x2="1049" y1="1778.4141" y2="1820.25"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1049" x2="1049" y1="1820.25" y2="2232.7656"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1174" x2="1174" y1="97.6016" y2="668.875"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1174" x2="1174" y1="668.875" y2="710.7109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1174" x2="1174" y1="710.7109" y2="1778.4141"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1174" x2="1174" y1="1778.4141" y2="1820.25"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1174" x2="1174" y1="1820.25" y2="2232.7656"/><rect fill="#FEFECE" filter="url(#f1mlkp6alvso4b)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="87" x="23" y="60.9922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="30" y="82.5254">GateServer</text><rect fill="#FEFECE" filter="url(#f1mlkp6alvso4b)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="87" x="23" y="2231.7656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="30" y="2253.2988">GateServer</text><rect fill="#FEFECE" filter="url(#f1mlkp6alvso4b)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="140" x="124" y="60.9922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="126" x="131" y="82.5254">PlayerDataManager</text><rect fill="#FEFECE" filter="url(#f1mlkp6alvso4b)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="140" x="124" y="2231.7656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="126" x="131" y="2253.2988">PlayerDataManager</text><rect fill="#90EE90" filter="url(#f1mlkp6alvso4b)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="114" x="278" y="60.9922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="100" x="285" y="82.5254">BaseTownLogic</text><rect fill="#90EE90" filter="url(#f1mlkp6alvso4b)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="114" x="278" y="2231.7656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="100" x="285" y="2253.2988">BaseTownLogic</text><rect fill="#90EE90" filter="url(#f1mlkp6alvso4b)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="104" x="536" y="60.9922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="543" y="82.5254">LogicManager</text><rect fill="#90EE90" filter="url(#f1mlkp6alvso4b)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="104" x="536" y="2231.7656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="543" y="2253.2988">LogicManager</text><rect fill="#FEFECE" filter="url(#f1mlkp6alvso4b)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="70" x="719" y="60.9922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="726" y="82.5254">&#x4E0A;&#x4E2A;&#x7CFB;&#x7EDF;</text><rect fill="#FEFECE" filter="url(#f1mlkp6alvso4b)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="70" x="719" y="2231.7656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="726" y="2253.2988">&#x4E0A;&#x4E2A;&#x7CFB;&#x7EDF;</text><rect fill="#FEFECE" filter="url(#f1mlkp6alvso4b)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="130" x="803" y="60.9922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="116" x="810" y="82.5254">ClientSystemTown</text><rect fill="#FEFECE" filter="url(#f1mlkp6alvso4b)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="130" x="803" y="2231.7656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="116" x="810" y="2253.2988">ClientSystemTown</text><rect fill="#FEFECE" filter="url(#f1mlkp6alvso4b)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="70" x="1012" y="60.9922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="1019" y="82.5254">&#x4E0B;&#x4E2A;&#x7CFB;&#x7EDF;</text><rect fill="#FEFECE" filter="url(#f1mlkp6alvso4b)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="70" x="1012" y="2231.7656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="1019" y="2253.2988">&#x4E0B;&#x4E2A;&#x7CFB;&#x7EDF;</text><rect fill="#FEFECE" filter="url(#f1mlkp6alvso4b)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="152" x="1096" y="60.9922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="138" x="1103" y="82.5254">ClientSystemManager</text><rect fill="#FEFECE" filter="url(#f1mlkp6alvso4b)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="152" x="1096" y="2231.7656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="138" x="1103" y="2253.2988">ClientSystemManager</text><rect fill="#FFFFFF" filter="url(#f1mlkp6alvso4b)" height="121.4063" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="63.5" y="733.0625"/><rect fill="#8FBC8F" filter="url(#f1mlkp6alvso4b)" height="984.6484" style="stroke: #8FBC8F; stroke-width: 1.0;" width="10" x="332" y="793.7656"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="332" x2="332" y1="793.7656" y2="1778.4141"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="342" x2="342" y1="793.7656" y2="1778.4141"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="332" x2="342" y1="793.7656" y2="793.7656"/><rect fill="#8FBC8F" filter="url(#f1mlkp6alvso4b)" height="394.5156" style="stroke: #8FBC8F; stroke-width: 1.0;" width="10" x="332" y="1820.25"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="332" x2="332" y1="1820.25" y2="2214.7656"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="342" x2="342" y1="1820.25" y2="2214.7656"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="332" x2="342" y1="2214.7656" y2="2214.7656"/><rect fill="#ADD8E6" filter="url(#f1mlkp6alvso4b)" height="36.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="585" y="265.0078"/><rect fill="#ADD8E6" filter="url(#f1mlkp6alvso4b)" height="36.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="585" y="531.4688"/><rect fill="#ADD8E6" filter="url(#f1mlkp6alvso4b)" height="36.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="585" y="946.8438"/><rect fill="#ADD8E6" filter="url(#f1mlkp6alvso4b)" height="73.7031" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="585" y="1652.3594"/><rect fill="#ADD8E6" filter="url(#f1mlkp6alvso4b)" height="36.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="585" y="1872.9531"/><rect fill="#ADD8E6" filter="url(#f1mlkp6alvso4b)" height="36.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="585" y="2141.0625"/><rect fill="#FFFFFF" filter="url(#f1mlkp6alvso4b)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="751" y="174.3047"/><rect fill="#FFFFFF" filter="url(#f1mlkp6alvso4b)" height="36.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="751" y="383.0625"/><rect fill="#FFFFFF" filter="url(#f1mlkp6alvso4b)" height="365.5156" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="865" y="303.3594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="865" x2="865" y1="303.3594" y2="668.875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="875" x2="875" y1="303.3594" y2="668.875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="865" x2="875" y1="303.3594" y2="303.3594"/><rect fill="#FFFFFF" filter="url(#f1mlkp6alvso4b)" height="1067.7031" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="865" y="710.7109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="865" x2="865" y1="710.7109" y2="1778.4141"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="875" x2="875" y1="710.7109" y2="1778.4141"/><rect fill="#FFFFFF" filter="url(#f1mlkp6alvso4b)" height="403.5156" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="865" y="1820.25"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="865" x2="865" y1="1820.25" y2="2223.7656"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="875" x2="875" y1="1820.25" y2="2223.7656"/><rect fill="#FFFFFF" filter="url(#f1mlkp6alvso4b)" height="167.7578" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="870" y="501.1172"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="870" x2="870" y1="501.1172" y2="668.875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="880" x2="880" y1="501.1172" y2="668.875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="870" x2="880" y1="501.1172" y2="501.1172"/><rect fill="#FFFFFF" filter="url(#f1mlkp6alvso4b)" height="1015.3516" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="870" y="710.7109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="870" x2="870" y1="710.7109" y2="1726.0625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="880" x2="880" y1="710.7109" y2="1726.0625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="870" x2="880" y1="1726.0625" y2="1726.0625"/><rect fill="#FFFFFF" filter="url(#f1mlkp6alvso4b)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="870" y="1946.6563"/><rect fill="#FFFFFF" filter="url(#f1mlkp6alvso4b)" height="147.4063" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="870" y="2067.3594"/><rect fill="#FFFFFF" filter="url(#f1mlkp6alvso4b)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1044" y="2007.0078"/><rect fill="#FFFFFF" filter="url(#f1mlkp6alvso4b)" height="561.2734" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="1169" y="107.6016"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1169" x2="1169" y1="107.6016" y2="668.875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1179" x2="1179" y1="107.6016" y2="668.875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1169" x2="1179" y1="107.6016" y2="107.6016"/><rect fill="#FFFFFF" filter="url(#f1mlkp6alvso4b)" height="1015.3516" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="1169" y="710.7109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1169" x2="1169" y1="710.7109" y2="1726.0625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1179" x2="1179" y1="710.7109" y2="1726.0625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1169" x2="1179" y1="1726.0625" y2="1726.0625"/><rect fill="#EEEEEE" filter="url(#f1mlkp6alvso4b)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1285" x="3" y="128.7773"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1288" y1="128.7773" y2="128.7773"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1288" y1="131.7773" y2="131.7773"/><rect fill="#EEEEEE" filter="url(#f1mlkp6alvso4b)" height="24.3516" style="stroke: #000000; stroke-width: 2.0;" width="46" x="622.5" y="117.6016"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28" x="628.5" y="135.0967">&#x6536;&#x96C6;</text><polygon fill="#A80036" points="772,170.3047,762,174.3047,772,178.3047,768,174.3047" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="766" x2="1168" y1="174.3047" y2="174.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="778" y="169.4482">&#x6536;&#x96C6;Exit</text><polygon fill="#A80036" points="881,230.6563,871,234.6563,881,238.6563,877,234.6563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="875" x2="1168" y1="234.6563" y2="234.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="57" x="887" y="229.7998">&#x6536;&#x96C6;Enter</text><ellipse cx="594.5" cy="264.2578" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="611.5,261.0078,601.5,265.0078,611.5,269.0078,607.5,265.0078" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="609.5" x2="869" y1="265.0078" y2="265.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="612" y="260.1514">OnSystemPrepareEnter</text><ellipse cx="599.5" cy="307.6094" fill="none" rx="4" ry="4" style="stroke: #FF0000; stroke-width: 1.5;"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="600" x2="642" y1="295.3594" y2="295.3594"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="642" x2="642" y1="295.3594" y2="308.3594"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="605" x2="642" y1="308.3594" y2="308.3594"/><polygon fill="#FF0000" points="615,304.3594,605,308.3594,615,312.3594,611,308.3594" style="stroke: #FF0000; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="132" x="607" y="290.5029">State: OnPrepareEnter</text><rect fill="#EEEEEE" filter="url(#f1mlkp6alvso4b)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1285" x="3" y="337.5352"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1288" y1="337.5352" y2="337.5352"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1288" y1="340.5352" y2="340.5352"/><rect fill="#EEEEEE" filter="url(#f1mlkp6alvso4b)" height="24.3516" style="stroke: #000000; stroke-width: 2.0;" width="42" x="624.5" y="326.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="24" x="630.5" y="343.8545">Exit</text><polygon fill="#A80036" points="772,379.0625,762,383.0625,772,387.0625,768,383.0625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="766" x2="1168" y1="383.0625" y2="383.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="778" y="378.2061">&#x6267;&#x884C; Exit &#x534F;&#x7A0B;</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="761" x2="803" y1="418.4141" y2="418.4141"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="803" x2="803" y1="418.4141" y2="431.4141"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="756" x2="803" y1="431.4141" y2="431.4141"/><polygon fill="#A80036" points="766,427.4141,756,431.4141,766,435.4141,762,431.4141" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="40" x="768" y="413.5576">OnExit</text><rect fill="#EEEEEE" filter="url(#f1mlkp6alvso4b)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1285" x="3" y="455.5898"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1288" y1="455.5898" y2="455.5898"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1288" y1="458.5898" y2="458.5898"/><rect fill="#EEEEEE" filter="url(#f1mlkp6alvso4b)" height="24.3516" style="stroke: #000000; stroke-width: 2.0;" width="51" x="620" y="444.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="33" x="626" y="461.9092">Enter</text><polygon fill="#A80036" points="891,497.1172,881,501.1172,891,505.1172,887,501.1172" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="885" x2="1168" y1="501.1172" y2="501.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="897" y="496.2607">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="908" y="496.2607">&#x6267;&#x884C; Enter &#x534F;&#x7A0B;</text><ellipse cx="594.5" cy="530.7188" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="611.5,527.4688,601.5,531.4688,611.5,535.4688,607.5,531.4688" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="609.5" x2="869" y1="531.4688" y2="531.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="612" y="526.6123">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="623" y="526.6123">OnSystemBeginEnter</text><ellipse cx="588.5" cy="579.0703" fill="none" rx="4" ry="4" style="stroke: #FF0000; stroke-width: 1.5;"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="595" x2="637" y1="566.8203" y2="566.8203"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="637" x2="637" y1="566.8203" y2="579.8203"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="594" x2="637" y1="579.8203" y2="579.8203"/><polygon fill="#FF0000" points="604,575.8203,594,579.8203,604,583.8203,600,579.8203" style="stroke: #FF0000; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="602" y="561.9639">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="613" y="561.9639">State: OnBeginEnter</text><polygon fill="#A80036" points="207,601.1719,197,605.1719,207,609.1719,203,605.1719" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="201" x2="869" y1="605.1719" y2="605.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="213" y="600.3154">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="224" y="600.3154">BindNetMessage</text><path d="M13,620.1719 L74,620.1719 L74,628.1719 L64,638.1719 L13,638.1719 L13,620.1719 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="451.7266" style="stroke: #000000; stroke-width: 2.0;" width="1265" x="13" y="620.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="28" y="634.667">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="86" x="89" y="633.5908">[&#x6210;&#x529F;: &#x8FD4;&#x56DE;&#x6D88;&#x606F;]</text><polygon fill="#A80036" points="79.5,656.875,69.5,660.875,79.5,664.875,75.5,660.875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="73.5" x2="869" y1="660.875" y2="660.875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="85.5" y="656.0186">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="96.5" y="656.0186">GameEnterReq</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="58" x="592.25" y="694.2939">&#x65F6;&#x95F4; &#x8FC7;&#x53BB;&#x4E86;</text><polygon fill="#A80036" points="858,729.0625,868,733.0625,858,737.0625,862,733.0625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="73.5" x2="864" y1="733.0625" y2="733.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="80.5" y="728.2061">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="91.5" y="728.2061">SysNotifyEnterScene</text><ellipse cx="589.5" cy="762.6641" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="572.5,759.4141,582.5,763.4141,572.5,767.4141,576.5,763.4141" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="73.5" x2="578.5" y1="763.4141" y2="763.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="80.5" y="758.5576">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="91.5" y="758.5576">SysNotifyEnterScene</text><ellipse cx="341.5" cy="793.0156" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="358.5,789.7656,348.5,793.7656,358.5,797.7656,354.5,793.7656" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="356.5" x2="589" y1="793.7656" y2="793.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="359" y="788.9092">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="370" y="788.9092">Create()</text><polygon fill="#A80036" points="858,820.1172,868,824.1172,858,828.1172,862,824.1172" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="73.5" x2="864" y1="824.1172" y2="824.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="80.5" y="819.2607">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="91.5" y="819.2607">NotifyList</text><polygon fill="#A80036" points="858,850.4688,868,854.4688,858,858.4688,862,854.4688" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="68.5" x2="864" y1="854.4688" y2="854.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="75.5" y="849.6123">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="93.5" y="849.6123">GameEnterRes</text><polygon fill="#A80036" points="207,880.8203,197,884.8203,207,888.8203,203,884.8203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="201" x2="869" y1="884.8203" y2="884.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="213" y="879.9639">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="231" y="879.9639">SetNetMesssage</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="13" x2="1278" y1="893.8203" y2="893.8203"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80" x="18" y="905.2393">[&#x5355;&#x673A;&#x4E0D;&#x53D1;&#x6D88;&#x606F;]</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="13" x2="1278" y1="909.6563" y2="909.6563"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="158" x="18" y="921.0752">[&#x8D85;&#x65F6;, &#x6D88;&#x606F;&#x672A;&#x6536;&#x5230;&#x7B49;&#x5F02;&#x5E38;&#x60C5;&#x51B5;]</text><ellipse cx="594.5" cy="946.0938" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="611.5,942.8438,601.5,946.8438,611.5,950.8438,607.5,946.8438" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="609.5" x2="869" y1="946.8438" y2="946.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="612" y="941.9873">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="630" y="941.9873">OnError(&#x5404;&#x79CD;&#x60C5;&#x51B5;)</text><ellipse cx="588.5" cy="994.4453" fill="none" rx="4" ry="4" style="stroke: #FF0000; stroke-width: 1.5;"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="595" x2="637" y1="982.1953" y2="982.1953"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="637" x2="637" y1="982.1953" y2="995.1953"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="594" x2="637" y1="995.1953" y2="995.1953"/><polygon fill="#FF0000" points="604,991.1953,594,995.1953,604,999.1953,600,995.1953" style="stroke: #FF0000; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="602" y="977.3389">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="69" x="620" y="977.3389">State: None</text><ellipse cx="341.5" cy="1019.7969" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="358.5,1016.5469,348.5,1020.5469,358.5,1024.5469,354.5,1020.5469" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="356.5" x2="589" y1="1020.5469" y2="1020.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="359" y="1015.6904">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="377" y="1015.6904">Destroy() &#x9500;&#x6BC1;</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1179" x2="1221" y1="1050.8984" y2="1050.8984"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1221" x2="1221" y1="1050.8984" y2="1063.8984"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1180" x2="1221" y1="1063.8984" y2="1063.8984"/><polygon fill="#A80036" points="1190,1059.8984,1180,1063.8984,1190,1067.8984,1186,1063.8984" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="1186" y="1046.042">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="62" x="1204" y="1046.042">Quit2Login</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="880" x2="922" y1="1101.25" y2="1101.25"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="922" x2="922" y1="1101.25" y2="1114.25"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="881" x2="922" y1="1114.25" y2="1114.25"/><polygon fill="#A80036" points="891,1110.25,881,1114.25,891,1118.25,887,1114.25" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="887" y="1096.3936">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="121" x="905" y="1096.3936">PlayerBaseData.Pos</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="880" x2="922" y1="1144.6016" y2="1144.6016"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="922" x2="922" y1="1144.6016" y2="1157.6016"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="881" x2="922" y1="1157.6016" y2="1157.6016"/><polygon fill="#A80036" points="891,1153.6016,881,1157.6016,891,1161.6016,887,1157.6016" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="887" y="1139.7451">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="905" y="1139.7451">OtherPlayerDatas</text><ellipse cx="589.5" cy="1187.2031" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="606.5,1183.9531,596.5,1187.9531,606.5,1191.9531,602.5,1187.9531" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="604.5" x2="869" y1="1187.9531" y2="1187.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="607" y="1183.0967">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="150" x="625" y="1183.0967">OnEventSceneNotifyEnter</text><ellipse cx="341.5" cy="1217.5547" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="358.5,1214.3047,348.5,1218.3047,358.5,1222.3047,354.5,1218.3047" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="356.5" x2="589" y1="1218.3047" y2="1218.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="359" y="1213.4482">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="206" x="377" y="1213.4482">OnEventSceneNotifyEnter &#x901A;&#x77E5;&#x8FDB;&#x5165;</text><path d="M268,1233.3047 L329,1233.3047 L329,1241.3047 L319,1251.3047 L268,1251.3047 L268,1233.3047 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="285.6484" style="stroke: #000000; stroke-width: 2.0;" width="781" x="268" y="1233.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="283" y="1247.7998">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="344" y="1246.7236">[&#x573A;&#x666F;]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="880" x2="922" y1="1274.0078" y2="1274.0078"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="922" x2="922" y1="1274.0078" y2="1287.0078"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="881" x2="922" y1="1287.0078" y2="1287.0078"/><polygon fill="#A80036" points="891,1283.0078,881,1287.0078,891,1291.0078,887,1287.0078" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="887" y="1269.1514">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="905" y="1269.1514">InitScene</text><ellipse cx="589.5" cy="1316.6094" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="606.5,1313.3594,596.5,1317.3594,606.5,1321.3594,602.5,1317.3594" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="604.5" x2="869" y1="1317.3594" y2="1317.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="607" y="1312.5029">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="625" y="1312.5029">OnSceceObjectCreate()</text><ellipse cx="341.5" cy="1346.9609" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="358.5,1343.7109,348.5,1347.7109,358.5,1351.7109,354.5,1347.7109" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="356.5" x2="589" y1="1347.7109" y2="1347.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="359" y="1342.8545">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="377" y="1342.8545">OnSceceObjectCreate()</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="268" x2="1049" y1="1356.7109" y2="1356.7109"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="187" x="273" y="1368.1299">[&#x754C;&#x9762;:&#x5173;&#x5361;&#x9009;&#x62E9;&#x754C;&#x9762; PK&#x7EC3;&#x4E60;&#x573A; &#x5F55;&#x50CF;]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="880" x2="922" y1="1393.8984" y2="1393.8984"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="922" x2="922" y1="1393.8984" y2="1406.8984"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="881" x2="922" y1="1406.8984" y2="1406.8984"/><polygon fill="#A80036" points="891,1402.8984,881,1406.8984,891,1410.8984,887,1406.8984" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="887" y="1389.042">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="905" y="1389.042">InitScene</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="959" y="1389.042">(lastSceneID)</text><ellipse cx="589.5" cy="1436.5" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="606.5,1433.25,596.5,1437.25,606.5,1441.25,602.5,1437.25" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="604.5" x2="869" y1="1437.25" y2="1437.25"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="607" y="1432.3936">24</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="625" y="1432.3936">OnSceceObjectCreate()</text><ellipse cx="341.5" cy="1466.8516" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="358.5,1463.6016,348.5,1467.6016,358.5,1471.6016,354.5,1467.6016" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="356.5" x2="589" y1="1467.6016" y2="1467.6016"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="359" y="1462.7451">25</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="377" y="1462.7451">OnSceceObjectCreate()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="880" x2="922" y1="1497.9531" y2="1497.9531"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="922" x2="922" y1="1497.9531" y2="1510.9531"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="881" x2="922" y1="1510.9531" y2="1510.9531"/><polygon fill="#A80036" points="891,1506.9531,881,1510.9531,891,1514.9531,887,1510.9531" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="887" y="1493.0967">26</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="905" y="1493.0967">OpenEntryFrame</text><ellipse cx="589.5" cy="1547.5547" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="606.5,1544.3047,596.5,1548.3047,606.5,1552.3047,602.5,1548.3047" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="604.5" x2="869" y1="1548.3047" y2="1548.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="607" y="1543.4482">27</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="625" y="1543.4482">OnPostInitScene</text><ellipse cx="341.5" cy="1577.9063" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="358.5,1574.6563,348.5,1578.6563,358.5,1582.6563,354.5,1578.6563" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="356.5" x2="589" y1="1578.6563" y2="1578.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="359" y="1573.7998">28</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="106" x="377" y="1573.7998">OnPostInitScene()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="880" x2="922" y1="1609.0078" y2="1609.0078"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="922" x2="922" y1="1609.0078" y2="1622.0078"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="881" x2="922" y1="1622.0078" y2="1622.0078"/><polygon fill="#A80036" points="891,1618.0078,881,1622.0078,891,1626.0078,887,1622.0078" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="887" y="1604.1514">29</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="905" y="1604.1514">OnEnter</text><ellipse cx="594.5" cy="1651.6094" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="611.5,1648.3594,601.5,1652.3594,611.5,1656.3594,607.5,1652.3594" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="609.5" x2="869" y1="1652.3594" y2="1652.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="612" y="1647.5029">30</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="630" y="1647.5029">OnSystemPostEnter</text><ellipse cx="594.5" cy="1694.9609" fill="none" rx="4" ry="4" style="stroke: #FF0000; stroke-width: 1.5;"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="595" x2="637" y1="1682.7109" y2="1682.7109"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="637" x2="637" y1="1682.7109" y2="1695.7109"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="600" x2="637" y1="1695.7109" y2="1695.7109"/><polygon fill="#FF0000" points="610,1691.7109,600,1695.7109,610,1699.7109,606,1695.7109" style="stroke: #FF0000; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="602" y="1677.8545">31</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="620" y="1677.8545">State: Running</text><ellipse cx="341.5" cy="1725.3125" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="358.5,1722.0625,348.5,1726.0625,358.5,1730.0625,354.5,1726.0625" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="356.5" x2="589" y1="1726.0625" y2="1726.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="359" y="1721.2061">32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="377" y="1721.2061">Enter()</text><rect fill="#EEEEEE" filter="url(#f1mlkp6alvso4b)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1285" x="3" y="1755.2383"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1288" y1="1755.2383" y2="1755.2383"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1288" y1="1758.2383" y2="1758.2383"/><rect fill="#EEEEEE" filter="url(#f1mlkp6alvso4b)" height="24.3516" style="stroke: #000000; stroke-width: 2.0;" width="55" x="618" y="1744.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="37" x="624" y="1761.5576">UnInit</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="66" x="588.25" y="1803.833">&#x5F88;&#x957F;&#x65F6;&#x95F4;&#x8FC7;&#x53BB;</text><polygon fill="#A80036" points="886,1838.6016,876,1842.6016,886,1846.6016,882,1842.6016" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="880" x2="1173" y1="1842.6016" y2="1842.6016"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="892" y="1837.7451">33</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="910" y="1837.7451">&#x6536;&#x96C6;Exit</text><ellipse cx="594.5" cy="1872.2031" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="611.5,1868.9531,601.5,1872.9531,611.5,1876.9531,607.5,1872.9531" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="609.5" x2="864" y1="1872.9531" y2="1872.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="612" y="1868.0967">34</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="630" y="1868.0967">OnSystemPrepareExit</text><ellipse cx="588.5" cy="1920.5547" fill="none" rx="4" ry="4" style="stroke: #FF0000; stroke-width: 1.5;"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="595" x2="637" y1="1908.3047" y2="1908.3047"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="637" x2="637" y1="1908.3047" y2="1921.3047"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="594" x2="637" y1="1921.3047" y2="1921.3047"/><polygon fill="#FF0000" points="604,1917.3047,594,1921.3047,604,1925.3047,600,1921.3047" style="stroke: #FF0000; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="602" y="1903.4482">35</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="620" y="1903.4482">State: OnPrepareExit</text><ellipse cx="341.5" cy="1945.9063" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="358.5,1942.6563,348.5,1946.6563,358.5,1950.6563,354.5,1946.6563" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="356.5" x2="589" y1="1946.6563" y2="1946.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="359" y="1941.7998">36</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="23" x="377" y="1941.7998">Exit</text><polygon fill="#A80036" points="1065,2003.0078,1055,2007.0078,1065,2011.0078,1061,2007.0078" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1059" x2="1173" y1="2007.0078" y2="2007.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="1071" y="2002.1514">37</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="57" x="1089" y="2002.1514">&#x6536;&#x96C6;Enter</text><polygon fill="#A80036" points="891,2063.3594,881,2067.3594,891,2071.3594,887,2067.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="885" x2="1173" y1="2067.3594" y2="2067.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="897" y="2062.5029">38</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="915" y="2062.5029">&#x6267;&#x884C; Exit &#x534F;&#x7A0B;</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="880" x2="922" y1="2097.7109" y2="2097.7109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="922" x2="922" y1="2097.7109" y2="2110.7109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="881" x2="922" y1="2110.7109" y2="2110.7109"/><polygon fill="#A80036" points="891,2106.7109,881,2110.7109,891,2114.7109,887,2110.7109" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="887" y="2092.8545">39</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="40" x="905" y="2092.8545">OnExit</text><ellipse cx="594.5" cy="2140.3125" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="611.5,2137.0625,601.5,2141.0625,611.5,2145.0625,607.5,2141.0625" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="609.5" x2="869" y1="2141.0625" y2="2141.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="612" y="2136.2061">40</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="630" y="2136.2061">OnSystemPostExit</text><ellipse cx="588.5" cy="2188.6641" fill="none" rx="4" ry="4" style="stroke: #FF0000; stroke-width: 1.5;"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="595" x2="637" y1="2176.4141" y2="2176.4141"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="637" x2="637" y1="2176.4141" y2="2189.4141"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="594" x2="637" y1="2189.4141" y2="2189.4141"/><polygon fill="#FF0000" points="604,2185.4141,594,2189.4141,604,2193.4141,600,2189.4141" style="stroke: #FF0000; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="602" y="2171.5576">41</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="62" x="620" y="2171.5576">State: End</text><ellipse cx="336.5" cy="2214.0156" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="353.5,2210.7656,343.5,2214.7656,353.5,2218.7656,349.5,2214.7656" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="351.5" x2="589" y1="2214.7656" y2="2214.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="354" y="2209.9092">42</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="45" x="372" y="2209.9092">Destroy</text><!--MD5=[6e6892d63f919d853b9b2b7c0a0fe025]
@startuml

box "服务器"
participant GateServer order 1
end box

participant PlayerDataManager order 5

box "城镇逻辑" #LightBlue
participant BaseTownLogic order 9 #LightGreen
participant LogicManager order 13 #LightGreen
end box 

participant 上个系统 order 15
participant ClientSystemTown order 20
participant 下个系统 order 31
participant ClientSystemManager order 40

title Town-生命周期

== 收集 ==

activate ClientSystemManager
ClientSystemManager -> 上个系统 : 收集Exit
activate 上个系统
deactivate 上个系统

ClientSystemManager -> ClientSystemTown: 收集Enter
ClientSystemTown [#blue]->o LogicManager: OnSystemPrepareEnter
activate LogicManager #LightBlue
LogicManager [#red]->o LogicManager: State: OnPrepareEnter
deactivate LogicManager 
activate ClientSystemTown
deactivate ClientSystemTown

== Exit ==

ClientSystemManager -> 上个系统: 执行 Exit 协程
activate 上个系统
上个系统 -> 上个系统: OnExit

deactivate 上个系统

== Enter ==
autonumber 1

ClientSystemManager -> ClientSystemTown: 执行 Enter 协程
activate ClientSystemTown
ClientSystemTown [#blue]->o LogicManager: OnSystemBeginEnter
activate LogicManager #LightBlue
LogicManager [#red]->o LogicManager: State: OnBeginEnter
deactivate LogicManager

ClientSystemTown -> PlayerDataManager: BindNetMessage

alt 成功: 返回消息
    ClientSystemTown -> GateServer: GameEnterReq

    ... 时间 过去了 ...

    GateServer -> ClientSystemTown: SysNotifyEnterScene
    activate GateServer

    GateServer [#blue]->o LogicManager: SysNotifyEnterScene
    LogicManager [#blue]->o BaseTownLogic: Create()
    activate BaseTownLogic #DarkSeaGreen
    GateServer -> ClientSystemTown: NotifyList
    GateServer -> ClientSystemTown: GameEnterRes
    deactivate GateServer

    ClientSystemTown -> PlayerDataManager: SetNetMesssage
else 单机不发消息

else 超时, 消息未收到等异常情况
    ClientSystemTown [#blue]->o LogicManager: OnError(各种情况)
    activate LogicManager #LightBlue
    LogicManager [#red]->o LogicManager: State: None
    deactivate LogicManager 
    LogicManager [#blue]->o BaseTownLogic: Destroy() 销毁

    ClientSystemManager -> ClientSystemManager: Quit2Login
end


ClientSystemTown -> ClientSystemTown: PlayerBaseData.Pos
ClientSystemTown -> ClientSystemTown: OtherPlayerDatas

ClientSystemTown [#blue]->o LogicManager: OnEventSceneNotifyEnter
LogicManager [#blue]->o BaseTownLogic: OnEventSceneNotifyEnter 通知进入

alt 场景
    ClientSystemTown -> ClientSystemTown: InitScene
    ClientSystemTown [#blue]->o LogicManager : OnSceceObjectCreate()
    LogicManager [#blue]->o BaseTownLogic: OnSceceObjectCreate()
else 界面:关卡选择界面 PK练习场 录像
    ClientSystemTown -> ClientSystemTown : InitScene<font color=red>(lastSceneID)
    ClientSystemTown [#blue]->o LogicManager : OnSceceObjectCreate()
    LogicManager [#blue]->o BaseTownLogic: OnSceceObjectCreate()
    ClientSystemTown -> ClientSystemTown: OpenEntryFrame

end

ClientSystemTown [#blue]->o LogicManager: OnPostInitScene
LogicManager [#blue]->o BaseTownLogic: OnPostInitScene()

ClientSystemTown -> ClientSystemTown: OnEnter
ClientSystemTown [#blue]->o LogicManager: OnSystemPostEnter
activate LogicManager #LightBlue
LogicManager [#red]->o LogicManager: State: Running 
LogicManager [#blue]->o BaseTownLogic: Enter()
deactivate LogicManager 

deactivate ClientSystemTown


deactivate ClientSystemManager

== UnInit ==


... 很长时间过去 ...


ClientSystemManager -> ClientSystemTown : 收集Exit
ClientSystemTown -[#blue]>o LogicManager: OnSystemPrepareExit
activate LogicManager #LightBlue
LogicManager [#red]->o LogicManager: State: OnPrepareExit
deactivate LogicManager 
LogicManager -[#blue]>o BaseTownLogic: Exit

activate ClientSystemTown
deactivate ClientSystemTown
ClientSystemManager -> 下个系统: 收集Enter
activate 下个系统
deactivate 下个系统


ClientSystemManager -> ClientSystemTown: 执行 Exit 协程
activate ClientSystemTown
ClientSystemTown -> ClientSystemTown: OnExit
ClientSystemTown -[#blue]>o LogicManager: OnSystemPostExit
activate LogicManager #LightBlue
LogicManager [#red]->o LogicManager: State: End
deactivate LogicManager
LogicManager -[#blue]>o BaseTownLogic: Destroy
deactivate BaseTownLogic


deactivate ClientSystemTown


@enduml

PlantUML version 1.2020.10(Sun May 17 17:35:57 CST 2020)
(MIT source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) Client VM
Java Version: 1.8.0_251-b08
Operating System: Windows 10
Default Encoding: UTF-8
Language: zh
Country: CN
--></g></svg></p><h2 class="mume-header" id="%E6%96%B0%E7%9A%84-%E5%88%87%E6%8D%A2%E6%97%B6%E5%BA%8F%E5%9B%BE">&#x65B0;&#x7684; &#x5207;&#x6362;&#x65F6;&#x5E8F;&#x56FE;</h2>

<p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" contentscripttype="application/ecmascript" contentstyletype="text/css" height="2095px" preserveAspectRatio="none" style="width:997px;height:2095px;" version="1.1" viewBox="0 0 997 2095" width="997px" zoomAndPan="magnify"><defs><filter height="300%" id="f90vxwojb67bb" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="72" x="463" y="28.6855">&#x5207;&#x6362;&#x573A;&#x666F;</text><rect fill="#DDDDDD" height="2043.5313" style="stroke: #A80036; stroke-width: 1.0;" width="99" x="29" y="40.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="42" x="57.5" y="54.1357">&#x670D;&#x52A1;&#x5668;</text><rect fill="#ADD8E6" height="2043.5313" style="stroke: #A80036; stroke-width: 1.0;" width="453" x="130" y="40.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56" x="328.5" y="54.1357">&#x57CE;&#x9547;&#x903B;&#x8F91;</text><rect fill="#FFFFFF" filter="url(#f90vxwojb67bb)" height="61.1875" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="73.5" y="414.7656"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="73.5" x2="73.5" y1="414.7656" y2="475.9531"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="83.5" x2="83.5" y1="414.7656" y2="475.9531"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="73.5" x2="83.5" y1="414.7656" y2="414.7656"/><rect fill="#FFFFFF" filter="url(#f90vxwojb67bb)" height="326.6719" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="73.5" y="517.7891"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="73.5" x2="73.5" y1="517.7891" y2="844.4609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="83.5" x2="83.5" y1="517.7891" y2="844.4609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="73.5" x2="83.5" y1="844.4609" y2="844.4609"/><rect fill="#8FBC8F" filter="url(#f90vxwojb67bb)" height="368.3516" style="stroke: #8FBC8F; stroke-width: 1.0;" width="10" x="201.5" y="107.6016"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="201.5" x2="201.5" y1="107.6016" y2="475.9531"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="211.5" x2="211.5" y1="107.6016" y2="475.9531"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="201.5" x2="211.5" y1="107.6016" y2="107.6016"/><rect fill="#8FBC8F" filter="url(#f90vxwojb67bb)" height="435.0781" style="stroke: #8FBC8F; stroke-width: 1.0;" width="10" x="201.5" y="517.7891"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="201.5" x2="201.5" y1="517.7891" y2="952.8672"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="211.5" x2="211.5" y1="517.7891" y2="952.8672"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="201.5" x2="211.5" y1="952.8672" y2="952.8672"/><rect fill="#E9967A" filter="url(#f90vxwojb67bb)" height="1361.0156" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="343" y="651.5469"/><rect fill="#ADD8E6" filter="url(#f90vxwojb67bb)" height="36.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="520" y="155.3047"/><rect fill="#ADD8E6" filter="url(#f90vxwojb67bb)" height="73.7031" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="520" y="1388.5938"/><rect fill="#ADD8E6" filter="url(#f90vxwojb67bb)" height="36.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="520" y="1582.1875"/><rect fill="#ADD8E6" filter="url(#f90vxwojb67bb)" height="36.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="520" y="1823.9688"/><rect fill="#FFFFFF" filter="url(#f90vxwojb67bb)" height="115.0547" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="700" y="237.0078"/><rect fill="#FFFFFF" filter="url(#f90vxwojb67bb)" height="1912.9609" style="stroke: #000000; stroke-width: 2.0;" width="972" x="13" y="114.6016"/><rect fill="#FFFFFF" filter="url(#f90vxwojb67bb)" height="94.8906" style="stroke: #000000; stroke-width: 2.0;" width="759" x="23" y="374.0625"/><rect fill="#FFFFFF" height="46.1875" style="stroke: none; stroke-width: 1.0;" width="759" x="23" y="422.7656"/><rect fill="#FFFFFF" filter="url(#f90vxwojb67bb)" height="312.6719" style="stroke: #000000; stroke-width: 2.0;" width="759" x="23" y="524.7891"/><rect fill="#FFFFFF" filter="url(#f90vxwojb67bb)" height="64.5391" style="stroke: #000000; stroke-width: 2.0;" width="310" x="279" y="610.8438"/><rect fill="#FFFFFF" height="15.8359" style="stroke: none; stroke-width: 1.0;" width="310" x="279" y="659.5469"/><rect fill="#FFFFFF" height="124.7266" style="stroke: none; stroke-width: 1.0;" width="759" x="23" y="712.7344"/><rect fill="#FFFFFF" filter="url(#f90vxwojb67bb)" height="64.5391" style="stroke: #000000; stroke-width: 2.0;" width="310" x="279" y="765.9219"/><rect fill="#FFFFFF" height="15.8359" style="stroke: none; stroke-width: 1.0;" width="310" x="279" y="814.625"/><rect fill="#FFFFFF" filter="url(#f90vxwojb67bb)" height="155.5938" style="stroke: #000000; stroke-width: 2.0;" width="465" x="124" y="881.8125"/><rect fill="#FFFFFF" height="46.1875" style="stroke: none; stroke-width: 1.0;" width="465" x="124" y="991.2188"/><rect fill="#FFFFFF" filter="url(#f90vxwojb67bb)" height="94.8906" style="stroke: #000000; stroke-width: 2.0;" width="465" x="124" y="1125.1094"/><rect fill="#FFFFFF" height="46.1875" style="stroke: none; stroke-width: 1.0;" width="465" x="124" y="1173.8125"/><rect fill="#FFFFFF" filter="url(#f90vxwojb67bb)" height="94.8906" style="stroke: #000000; stroke-width: 2.0;" width="465" x="124" y="1264.3516"/><rect fill="#FFFFFF" height="46.1875" style="stroke: none; stroke-width: 1.0;" width="465" x="124" y="1313.0547"/><rect fill="#FFFFFF" height="241.7813" style="stroke: none; stroke-width: 1.0;" width="972" x="13" y="1544"/><rect fill="#FFFFFF" filter="url(#f90vxwojb67bb)" height="64.5391" style="stroke: #000000; stroke-width: 2.0;" width="310" x="279" y="1640.5391"/><rect fill="#FFFFFF" height="15.8359" style="stroke: none; stroke-width: 1.0;" width="310" x="279" y="1689.2422"/><rect fill="#FFFFFF" height="241.7813" style="stroke: none; stroke-width: 1.0;" width="972" x="13" y="1785.7813"/><rect fill="#FFFFFF" filter="url(#f90vxwojb67bb)" height="64.5391" style="stroke: #000000; stroke-width: 2.0;" width="310" x="279" y="1882.3203"/><rect fill="#FFFFFF" height="15.8359" style="stroke: none; stroke-width: 1.0;" width="310" x="279" y="1931.0234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="78" x2="78" y1="97.6016" y2="475.9531"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="78" x2="78" y1="475.9531" y2="517.7891"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="78" x2="78" y1="517.7891" y2="2044.5625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="206" x2="206" y1="97.6016" y2="475.9531"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="206" x2="206" y1="475.9531" y2="517.7891"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="206" x2="206" y1="517.7891" y2="2044.5625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="348" x2="348" y1="97.6016" y2="475.9531"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="348" x2="348" y1="475.9531" y2="517.7891"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="348" x2="348" y1="517.7891" y2="2044.5625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="525" x2="525" y1="97.6016" y2="475.9531"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="525" x2="525" y1="475.9531" y2="517.7891"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="525" x2="525" y1="517.7891" y2="2044.5625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="705" x2="705" y1="97.6016" y2="475.9531"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="705" x2="705" y1="475.9531" y2="517.7891"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="705" x2="705" y1="517.7891" y2="2044.5625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="931" x2="931" y1="97.6016" y2="475.9531"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="931" x2="931" y1="475.9531" y2="517.7891"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="931" x2="931" y1="517.7891" y2="2044.5625"/><rect fill="#FEFECE" filter="url(#f90vxwojb67bb)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="87" x="33" y="60.9922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="40" y="82.5254">GateServer</text><rect fill="#FEFECE" filter="url(#f90vxwojb67bb)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="87" x="33" y="2043.5625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="40" y="2065.0957">GateServer</text><rect fill="#90EE90" filter="url(#f90vxwojb67bb)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="141" x="134" y="60.9922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="127" x="141" y="82.5254">LastBaseTownLogic</text><rect fill="#90EE90" filter="url(#f90vxwojb67bb)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="141" x="134" y="2043.5625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="127" x="141" y="2065.0957">LastBaseTownLogic</text><rect fill="#90EE90" filter="url(#f90vxwojb67bb)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="114" x="289" y="60.9922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="100" x="296" y="82.5254">BaseTownLogic</text><rect fill="#90EE90" filter="url(#f90vxwojb67bb)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="114" x="289" y="2043.5625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="100" x="296" y="2065.0957">BaseTownLogic</text><rect fill="#90EE90" filter="url(#f90vxwojb67bb)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="104" x="471" y="60.9922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="478" y="82.5254">LogicManager</text><rect fill="#90EE90" filter="url(#f90vxwojb67bb)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="104" x="471" y="2043.5625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="478" y="2065.0957">LogicManager</text><rect fill="#FEFECE" filter="url(#f90vxwojb67bb)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="130" x="638" y="60.9922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="116" x="645" y="82.5254">ClientSystemTown</text><rect fill="#FEFECE" filter="url(#f90vxwojb67bb)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="130" x="638" y="2043.5625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="116" x="645" y="2065.0957">ClientSystemTown</text><rect fill="#FEFECE" filter="url(#f90vxwojb67bb)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="84" x="887" y="60.9922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="894" y="82.5254">MainPlayer</text><rect fill="#FEFECE" filter="url(#f90vxwojb67bb)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="84" x="887" y="2043.5625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="894" y="2065.0957">MainPlayer</text><rect fill="#FFFFFF" filter="url(#f90vxwojb67bb)" height="61.1875" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="73.5" y="414.7656"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="73.5" x2="73.5" y1="414.7656" y2="475.9531"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="83.5" x2="83.5" y1="414.7656" y2="475.9531"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="73.5" x2="83.5" y1="414.7656" y2="414.7656"/><rect fill="#FFFFFF" filter="url(#f90vxwojb67bb)" height="326.6719" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="73.5" y="517.7891"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="73.5" x2="73.5" y1="517.7891" y2="844.4609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="83.5" x2="83.5" y1="517.7891" y2="844.4609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="73.5" x2="83.5" y1="844.4609" y2="844.4609"/><rect fill="#8FBC8F" filter="url(#f90vxwojb67bb)" height="368.3516" style="stroke: #8FBC8F; stroke-width: 1.0;" width="10" x="201.5" y="107.6016"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="201.5" x2="201.5" y1="107.6016" y2="475.9531"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="211.5" x2="211.5" y1="107.6016" y2="475.9531"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="201.5" x2="211.5" y1="107.6016" y2="107.6016"/><rect fill="#8FBC8F" filter="url(#f90vxwojb67bb)" height="435.0781" style="stroke: #8FBC8F; stroke-width: 1.0;" width="10" x="201.5" y="517.7891"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="201.5" x2="201.5" y1="517.7891" y2="952.8672"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="211.5" x2="211.5" y1="517.7891" y2="952.8672"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="201.5" x2="211.5" y1="952.8672" y2="952.8672"/><rect fill="#E9967A" filter="url(#f90vxwojb67bb)" height="1361.0156" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="343" y="651.5469"/><rect fill="#ADD8E6" filter="url(#f90vxwojb67bb)" height="36.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="520" y="155.3047"/><rect fill="#ADD8E6" filter="url(#f90vxwojb67bb)" height="73.7031" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="520" y="1388.5938"/><rect fill="#ADD8E6" filter="url(#f90vxwojb67bb)" height="36.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="520" y="1582.1875"/><rect fill="#ADD8E6" filter="url(#f90vxwojb67bb)" height="36.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="520" y="1823.9688"/><rect fill="#FFFFFF" filter="url(#f90vxwojb67bb)" height="115.0547" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="700" y="237.0078"/><path d="M13,114.6016 L74,114.6016 L74,122.6016 L64,132.6016 L13,132.6016 L13,114.6016 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1912.9609" style="stroke: #000000; stroke-width: 2.0;" width="972" x="13" y="114.6016"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="28" y="129.0967">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56" x="89" y="128.0205">[&#x6B63;&#x5E38;&#x60C5;&#x51B5;]</text><ellipse cx="529.5" cy="154.5547" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="546.5,151.3047,536.5,155.3047,546.5,159.3047,542.5,155.3047" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="544.5" x2="704" y1="155.3047" y2="155.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="547" y="150.4482">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="558" y="150.4482">OnStartChange</text><ellipse cx="523.5" cy="202.9063" fill="none" rx="4" ry="4" style="stroke: #FF0000; stroke-width: 1.5;"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="530" x2="572" y1="190.6563" y2="190.6563"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="572" x2="572" y1="190.6563" y2="203.6563"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="529" x2="572" y1="203.6563" y2="203.6563"/><polygon fill="#FF0000" points="539,199.6563,529,203.6563,539,207.6563,535,203.6563" style="stroke: #FF0000; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="537" y="185.7998">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="93" x="548" y="185.7998">State: Changing</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="705" x2="752" y1="224.0078" y2="224.0078"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="752" x2="752" y1="224.0078" y2="237.0078"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="711" x2="752" y1="237.0078" y2="237.0078"/><polygon fill="#A80036" points="721,233.0078,711,237.0078,721,241.0078,717,237.0078" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="717" y="219.1514">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="728" y="219.1514">isswitcing(true)</text><polygon fill="#A80036" points="919,268.3594,929,272.3594,919,276.3594,923,272.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="710" x2="925" y1="272.3594" y2="272.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="717" y="267.5029">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="728" y="267.5029">enable(false)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="710" x2="752" y1="302.7109" y2="302.7109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="752" x2="752" y1="302.7109" y2="315.7109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="711" x2="752" y1="315.7109" y2="315.7109"/><polygon fill="#A80036" points="721,311.7109,711,315.7109,721,319.7109,717,315.7109" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="717" y="297.8545">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="728" y="297.8545">_UnbindSceneNetMessage</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="710" x2="752" y1="351.0625" y2="351.0625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="752" x2="752" y1="351.0625" y2="364.0625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="705" x2="752" y1="364.0625" y2="364.0625"/><polygon fill="#A80036" points="715,360.0625,705,364.0625,715,368.0625,711,364.0625" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="717" y="346.2061">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="728" y="346.2061">_OnBindExtraSceneNetMessage</text><path d="M23,374.0625 L84,374.0625 L84,382.0625 L74,392.0625 L23,392.0625 L23,374.0625 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="94.8906" style="stroke: #000000; stroke-width: 2.0;" width="759" x="23" y="374.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="38" y="388.5576">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="92" x="99" y="387.4814">[&#x8FD4;&#x56DE;&#x4E0A;&#x4E00;&#x4E2A;&#x573A;&#x666F;]</text><polygon fill="#A80036" points="94.5,410.7656,84.5,414.7656,94.5,418.7656,90.5,414.7656" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="88.5" x2="704" y1="414.7656" y2="414.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="100.5" y="409.9092">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="111.5" y="409.9092">SceneReturnToTown</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="23" x2="782" y1="423.7656" y2="423.7656"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="92" x="28" y="435.1846">[&#x5728;&#x57CE;&#x9547;&#x4E4B;&#x95F4;&#x5207;&#x6362;]</text><polygon fill="#A80036" points="94.5,456.9531,84.5,460.9531,94.5,464.9531,90.5,460.9531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="88.5" x2="704" y1="460.9531" y2="460.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="100.5" y="456.0967">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="178" x="111.5" y="456.0967">ScenePlayerChangeSceneReq</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="58" x="475.75" y="501.3721">&#x65F6;&#x95F4; &#x8FC7;&#x53BB;&#x4E86;</text><path d="M23,524.7891 L84,524.7891 L84,532.7891 L74,542.7891 L23,542.7891 L23,524.7891 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="312.6719" style="stroke: #000000; stroke-width: 2.0;" width="759" x="23" y="524.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="38" y="539.2842">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="99" y="538.208">[&#x6210;&#x529F;]</text><polygon fill="#A80036" points="693,561.4922,703,565.4922,693,569.4922,697,565.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="83.5" x2="699" y1="565.4922" y2="565.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="90.5" y="560.6357">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="101.5" y="560.6357">SysNotifyEnterScene</text><ellipse cx="524.5" cy="595.0938" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="507.5,591.8438,517.5,595.8438,507.5,599.8438,511.5,595.8438" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="83.5" x2="513.5" y1="595.8438" y2="595.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="90.5" y="590.9873">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="108.5" y="590.9873">SysNotifyEnterScene</text><path d="M279,610.8438 L340,610.8438 L340,618.8438 L330,628.8438 L279,628.8438 L279,610.8438 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="64.5391" style="stroke: #000000; stroke-width: 2.0;" width="310" x="279" y="610.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="294" y="625.3389">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="155" x="355" y="624.2627">[&#x4E0D;&#x540C;&#x7C7B;&#x578B; &#x4F8B;&#x5982;&#x666E;&#x901A;&#x5230;&#x5F02;&#x6B21;&#x5143;]</text><ellipse cx="352.5" cy="650.7969" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="369.5,647.5469,359.5,651.5469,369.5,655.5469,365.5,651.5469" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="367.5" x2="524" y1="651.5469" y2="651.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="370" y="646.6904">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="388" y="646.6904">&#x65B0;&#x7C7B;&#x578B; Create()</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="279" x2="589" y1="660.5469" y2="660.5469"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80" x="284" y="671.9658">[&#x76F8;&#x540C;&#x4E4B;&#x95F4;&#x5207;&#x6362;]</text><polygon fill="#A80036" points="693,700.7344,703,704.7344,693,708.7344,697,704.7344" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="83.5" x2="699" y1="704.7344" y2="704.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="90.5" y="699.8779">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="108.5" y="699.8779">NotifyList</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="23" x2="782" y1="713.7344" y2="713.7344"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="28" y="725.1533">[&#x5931;&#x8D25;]</text><polygon fill="#A80036" points="693,746.9219,703,750.9219,693,754.9219,697,750.9219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="83.5" x2="699" y1="750.9219" y2="750.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="90.5" y="746.0654">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="108.5" y="746.0654">&#x5931;&#x8D25;&#xFF0C;&#x8D85;&#x65F6;&#x7B49;&#x9519;&#x8BEF;&#x60C5;&#x51B5;</text><path d="M279,765.9219 L340,765.9219 L340,773.9219 L330,783.9219 L279,783.9219 L279,765.9219 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="64.5391" style="stroke: #000000; stroke-width: 2.0;" width="310" x="279" y="765.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="294" y="780.417">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="155" x="355" y="779.3408">[&#x4E0D;&#x540C;&#x7C7B;&#x578B; &#x4F8B;&#x5982;&#x666E;&#x901A;&#x5230;&#x5F02;&#x6B21;&#x5143;]</text><ellipse cx="352.5" cy="805.875" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="369.5,802.625,359.5,806.625,369.5,810.625,365.5,806.625" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="367.5" x2="524" y1="806.625" y2="806.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="370" y="801.7686">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="388" y="801.7686">&#x65B0;&#x7C7B;&#x578B; Destroy()</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="279" x2="589" y1="815.625" y2="815.625"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80" x="284" y="827.0439">[&#x76F8;&#x540C;&#x4E4B;&#x95F4;&#x5207;&#x6362;]</text><ellipse cx="524.5" cy="866.0625" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="541.5,862.8125,531.5,866.8125,541.5,870.8125,537.5,866.8125" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="539.5" x2="704" y1="866.8125" y2="866.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="542" y="861.9561">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="560" y="861.9561">OnSceneNotifyEnter</text><path d="M124,881.8125 L185,881.8125 L185,889.8125 L175,899.8125 L124,899.8125 L124,881.8125 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="155.5938" style="stroke: #000000; stroke-width: 2.0;" width="465" x="124" y="881.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="139" y="896.3076">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="155" x="200" y="895.2314">[&#x4E0D;&#x540C;&#x7C7B;&#x578B; &#x4F8B;&#x5982;&#x666E;&#x901A;&#x5230;&#x5F02;&#x6B21;&#x5143;]</text><ellipse cx="211" cy="921.7656" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="228,918.5156,218,922.5156,228,926.5156,224,922.5156" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="226" x2="524" y1="922.5156" y2="922.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="228.5" y="917.6592">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="246.5" y="917.6592">&#x539F;&#x6765; Exit()</text><ellipse cx="206" cy="952.1172" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="223,948.8672,213,952.8672,223,956.8672,219,952.8672" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="221" x2="524" y1="952.8672" y2="952.8672"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="223.5" y="948.0107">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="241.5" y="948.0107">&#x539F;&#x6765; Destroy()</text><ellipse cx="352.5" cy="982.4688" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="369.5,979.2188,359.5,983.2188,369.5,987.2188,365.5,983.2188" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="367.5" x2="524" y1="983.2188" y2="983.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="370" y="978.3623">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="388" y="978.3623">OnSceneNotifyEnter</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="124" x2="589" y1="992.2188" y2="992.2188"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80" x="129" y="1003.6377">[&#x76F8;&#x540C;&#x4E4B;&#x95F4;&#x5207;&#x6362;]</text><ellipse cx="206" cy="1028.6563" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="223,1025.4063,213,1029.4063,223,1033.4063,219,1029.4063" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="221" x2="524" y1="1029.4063" y2="1029.4063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="223.5" y="1024.5498">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="241.5" y="1024.5498">OnSceneNotifyEnter</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="705" x2="747" y1="1066.7578" y2="1066.7578"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="747" x2="747" y1="1066.7578" y2="1079.7578"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="706" x2="747" y1="1079.7578" y2="1079.7578"/><polygon fill="#A80036" points="716,1075.7578,706,1079.7578,716,1083.7578,712,1079.7578" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="712" y="1061.9014">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="730" y="1061.9014">InitializeScene</text><ellipse cx="524.5" cy="1109.3594" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="541.5,1106.1094,531.5,1110.1094,541.5,1114.1094,537.5,1110.1094" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="539.5" x2="704" y1="1110.1094" y2="1110.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="542" y="1105.2529">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="560" y="1105.2529">OnSceceObjectCreate()</text><path d="M124,1125.1094 L185,1125.1094 L185,1133.1094 L175,1143.1094 L124,1143.1094 L124,1125.1094 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="94.8906" style="stroke: #000000; stroke-width: 2.0;" width="465" x="124" y="1125.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="139" y="1139.6045">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="155" x="200" y="1138.5283">[&#x4E0D;&#x540C;&#x7C7B;&#x578B; &#x4F8B;&#x5982;&#x666E;&#x901A;&#x5230;&#x5F02;&#x6B21;&#x5143;]</text><ellipse cx="352.5" cy="1165.0625" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="369.5,1161.8125,359.5,1165.8125,369.5,1169.8125,365.5,1165.8125" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="367.5" x2="524" y1="1165.8125" y2="1165.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="370" y="1160.9561">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="388" y="1160.9561">OnSceceObjectCreate</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="124" x2="589" y1="1174.8125" y2="1174.8125"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80" x="129" y="1186.2314">[&#x76F8;&#x540C;&#x4E4B;&#x95F4;&#x5207;&#x6362;]</text><ellipse cx="206" cy="1211.25" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="223,1208,213,1212,223,1216,219,1212" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="221" x2="524" y1="1212" y2="1212"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="223.5" y="1207.1436">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="241.5" y="1207.1436">OnSceceObjectCreate</text><ellipse cx="524.5" cy="1248.6016" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="541.5,1245.3516,531.5,1249.3516,541.5,1253.3516,537.5,1249.3516" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="539.5" x2="704" y1="1249.3516" y2="1249.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="542" y="1244.4951">24</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="106" x="560" y="1244.4951">OnPostInitScene()</text><path d="M124,1264.3516 L185,1264.3516 L185,1272.3516 L175,1282.3516 L124,1282.3516 L124,1264.3516 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="94.8906" style="stroke: #000000; stroke-width: 2.0;" width="465" x="124" y="1264.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="139" y="1278.8467">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="155" x="200" y="1277.7705">[&#x4E0D;&#x540C;&#x7C7B;&#x578B; &#x4F8B;&#x5982;&#x666E;&#x901A;&#x5230;&#x5F02;&#x6B21;&#x5143;]</text><ellipse cx="352.5" cy="1304.3047" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="369.5,1301.0547,359.5,1305.0547,369.5,1309.0547,365.5,1305.0547" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="367.5" x2="524" y1="1305.0547" y2="1305.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="370" y="1300.1982">25</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="388" y="1300.1982">OnPostInitScene</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="124" x2="589" y1="1314.0547" y2="1314.0547"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80" x="129" y="1325.4736">[&#x76F8;&#x540C;&#x4E4B;&#x95F4;&#x5207;&#x6362;]</text><ellipse cx="206" cy="1350.4922" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="223,1347.2422,213,1351.2422,223,1355.2422,219,1351.2422" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="221" x2="524" y1="1351.2422" y2="1351.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="223.5" y="1346.3857">26</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="241.5" y="1346.3857">OnPostInitScene</text><ellipse cx="529.5" cy="1387.8438" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="546.5,1384.5938,536.5,1388.5938,546.5,1392.5938,542.5,1388.5938" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="544.5" x2="704" y1="1388.5938" y2="1388.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="547" y="1383.7373">27</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="565" y="1383.7373">OnFinishSwitch()</text><ellipse cx="529.5" cy="1431.1953" fill="none" rx="4" ry="4" style="stroke: #FF0000; stroke-width: 1.5;"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="530" x2="572" y1="1418.9453" y2="1418.9453"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="572" x2="572" y1="1418.9453" y2="1431.9453"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="535" x2="572" y1="1431.9453" y2="1431.9453"/><polygon fill="#FF0000" points="545,1427.9453,535,1431.9453,545,1435.9453,541,1431.9453" style="stroke: #FF0000; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="537" y="1414.0889">28</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="555" y="1414.0889">State: Running</text><ellipse cx="352.5" cy="1461.5469" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="369.5,1458.2969,359.5,1462.2969,369.5,1466.2969,365.5,1462.2969" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="367.5" x2="524" y1="1462.2969" y2="1462.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="370" y="1457.4404">29</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="388" y="1457.4404">&#x65B0;&#x7C7B;&#x578B; Enter()</text><polygon fill="#A80036" points="919,1488.6484,929,1492.6484,919,1496.6484,923,1492.6484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="705" x2="925" y1="1492.6484" y2="1492.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="712" y="1487.792">30</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="730" y="1487.792">enable(true)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="705" x2="747" y1="1528" y2="1528"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="747" x2="747" y1="1528" y2="1541"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="700" x2="747" y1="1541" y2="1541"/><polygon fill="#A80036" points="710,1537,700,1541,710,1545,706,1541" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="712" y="1523.1436">31</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="730" y="1523.1436">isswitcing(false)</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="13" x2="985" y1="1545" y2="1545"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="68" x="18" y="1556.4189">[&#x6B63;&#x5728;&#x5207;&#x6362;&#x4E2D;]</text><ellipse cx="529.5" cy="1581.4375" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="546.5,1578.1875,536.5,1582.1875,546.5,1586.1875,542.5,1582.1875" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="544.5" x2="704" y1="1582.1875" y2="1582.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="547" y="1577.3311">32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="53" x="565" y="1577.3311">OnError()</text><ellipse cx="523.5" cy="1629.7891" fill="none" rx="4" ry="4" style="stroke: #FF0000; stroke-width: 1.5;"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="530" x2="572" y1="1617.5391" y2="1617.5391"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="572" x2="572" y1="1617.5391" y2="1630.5391"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="529" x2="572" y1="1630.5391" y2="1630.5391"/><polygon fill="#FF0000" points="539,1626.5391,529,1630.5391,539,1634.5391,535,1630.5391" style="stroke: #FF0000; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="537" y="1612.6826">33</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="69" x="555" y="1612.6826">State: None</text><path d="M279,1640.5391 L340,1640.5391 L340,1648.5391 L330,1658.5391 L279,1658.5391 L279,1640.5391 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="64.5391" style="stroke: #000000; stroke-width: 2.0;" width="310" x="279" y="1640.5391"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="294" y="1655.0342">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="155" x="355" y="1653.958">[&#x4E0D;&#x540C;&#x7C7B;&#x578B; &#x4F8B;&#x5982;&#x666E;&#x901A;&#x5230;&#x5F02;&#x6B21;&#x5143;]</text><ellipse cx="352.5" cy="1680.4922" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="369.5,1677.2422,359.5,1681.2422,369.5,1685.2422,365.5,1681.2422" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="367.5" x2="524" y1="1681.2422" y2="1681.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="370" y="1676.3857">34</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="388" y="1676.3857">&#x65B0;&#x7C7B;&#x578B; Destroy()</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="279" x2="589" y1="1690.2422" y2="1690.2422"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80" x="284" y="1701.6611">[&#x76F8;&#x540C;&#x4E4B;&#x95F4;&#x5207;&#x6362;]</text><polygon fill="#A80036" points="919,1730.4297,929,1734.4297,919,1738.4297,923,1734.4297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="705" x2="925" y1="1734.4297" y2="1734.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="712" y="1729.5732">35</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="730" y="1729.5732">enable(true)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="705" x2="747" y1="1764.7813" y2="1764.7813"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="747" x2="747" y1="1764.7813" y2="1777.7813"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="706" x2="747" y1="1777.7813" y2="1777.7813"/><polygon fill="#A80036" points="716,1773.7813,706,1777.7813,716,1781.7813,712,1777.7813" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="712" y="1759.9248">36</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="730" y="1759.9248">isswitcing(false)</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="13" x2="985" y1="1786.7813" y2="1786.7813"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56" x="18" y="1798.2002">[&#x4E0D;&#x80FD;&#x5207;&#x6362;]</text><ellipse cx="529.5" cy="1823.2188" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="546.5,1819.9688,536.5,1823.9688,546.5,1827.9688,542.5,1823.9688" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="544.5" x2="704" y1="1823.9688" y2="1823.9688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="547" y="1819.1123">37</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="53" x="565" y="1819.1123">OnError()</text><ellipse cx="523.5" cy="1871.5703" fill="none" rx="4" ry="4" style="stroke: #FF0000; stroke-width: 1.5;"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="530" x2="572" y1="1859.3203" y2="1859.3203"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="572" x2="572" y1="1859.3203" y2="1872.3203"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="529" x2="572" y1="1872.3203" y2="1872.3203"/><polygon fill="#FF0000" points="539,1868.3203,529,1872.3203,539,1876.3203,535,1872.3203" style="stroke: #FF0000; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="537" y="1854.4639">38</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="69" x="555" y="1854.4639">State: None</text><path d="M279,1882.3203 L340,1882.3203 L340,1890.3203 L330,1900.3203 L279,1900.3203 L279,1882.3203 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="64.5391" style="stroke: #000000; stroke-width: 2.0;" width="310" x="279" y="1882.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="294" y="1896.8154">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="155" x="355" y="1895.7393">[&#x4E0D;&#x540C;&#x7C7B;&#x578B; &#x4F8B;&#x5982;&#x666E;&#x901A;&#x5230;&#x5F02;&#x6B21;&#x5143;]</text><ellipse cx="352.5" cy="1922.2734" fill="none" rx="4" ry="4" style="stroke: #0000FF; stroke-width: 1.5;"/><polygon fill="#0000FF" points="369.5,1919.0234,359.5,1923.0234,369.5,1927.0234,365.5,1923.0234" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="367.5" x2="524" y1="1923.0234" y2="1923.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="370" y="1918.167">39</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="388" y="1918.167">&#x65B0;&#x7C7B;&#x578B; Destroy()</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="279" x2="589" y1="1932.0234" y2="1932.0234"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80" x="284" y="1943.4424">[&#x76F8;&#x540C;&#x4E4B;&#x95F4;&#x5207;&#x6362;]</text><polygon fill="#A80036" points="919,1972.2109,929,1976.2109,919,1980.2109,923,1976.2109" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="705" x2="925" y1="1976.2109" y2="1976.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="712" y="1971.3545">40</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="730" y="1971.3545">enable(true)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="705" x2="747" y1="2011.5625" y2="2011.5625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="747" x2="747" y1="2011.5625" y2="2024.5625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="700" x2="747" y1="2024.5625" y2="2024.5625"/><polygon fill="#A80036" points="710,2020.5625,700,2024.5625,710,2028.5625,706,2024.5625" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="712" y="2006.7061">41</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="730" y="2006.7061">isswitcing(false)</text><!--MD5=[66eccd3497caa5c4fc3576e163a7196b]
@startuml

box "服务器"
participant GateServer order  5 
end box

box "城镇逻辑" #LightBlue
participant LastBaseTownLogic order 7 #LightGreen
participant BaseTownLogic order 8 #LightGreen
participant LogicManager order 11 #LightGreen
end box

participant ClientSystemTown order 20
participant MainPlayer order 41


title 切换场景

activate LastBaseTownLogic #DarkSeaGreen

autonumber 1
alt 正常情况

    ClientSystemTown [#blue]->o LogicManager: OnStartChange
    activate LogicManager #LightBlue
    LogicManager [#red]->o LogicManager: State: Changing
    deactivate LogicManager
    ClientSystemTown -> ClientSystemTown : isswitcing(true)
    activate ClientSystemTown
    ClientSystemTown -> MainPlayer : enable(false)
    ClientSystemTown -> ClientSystemTown : _UnbindSceneNetMessage
    ClientSystemTown -> ClientSystemTown : _OnBindExtraSceneNetMessage

    deactivate ClientSystemTown

    alt 返回上一个场景
        ClientSystemTown -> GateServer: SceneReturnToTown
        activate GateServer
    else 在城镇之间切换
        ClientSystemTown -> GateServer: ScenePlayerChangeSceneReq
    end

    ... 时间 过去了 ...

    alt 成功
        GateServer -> ClientSystemTown: SysNotifyEnterScene
        GateServer [#blue]->o LogicManager: SysNotifyEnterScene
        alt 不同类型 例如普通到异次元
            LogicManager [#blue]->o BaseTownLogic: 新类型 Create() 
            activate BaseTownLogic #DarkSalmon
        else 相同之间切换
        end

        GateServer -> ClientSystemTown: NotifyList
    else 失败
        GateServer -> ClientSystemTown: 失败，超时等错误情况

        alt 不同类型 例如普通到异次元
            LogicManager [#blue]->o BaseTownLogic: 新类型 Destroy() 
        else 相同之间切换
        end

    end


    deactivate GateServer

    activate ClientSystemTown
    ClientSystemTown [#blue]->o LogicManager: OnSceneNotifyEnter
    alt 不同类型 例如普通到异次元
        LogicManager [#blue]->o LastBaseTownLogic: 原来 Exit()
        LogicManager [#blue]->o LastBaseTownLogic: 原来 Destroy()
        deactivate LastBaseTownLogic 


        LogicManager [#blue]->o BaseTownLogic: OnSceneNotifyEnter
    else 相同之间切换
        LogicManager [#blue]->o LastBaseTownLogic: OnSceneNotifyEnter
    end


    activate ClientSystemTown
    ClientSystemTown -> ClientSystemTown :InitializeScene

    ClientSystemTown [#blue]->o LogicManager : OnSceceObjectCreate()

    alt 不同类型 例如普通到异次元
        LogicManager [#blue]->o BaseTownLogic: OnSceceObjectCreate
    else 相同之间切换
        LogicManager [#blue]->o LastBaseTownLogic: OnSceceObjectCreate
    end

    deactivate ClientSystemTown
    ClientSystemTown [#blue]->o LogicManager : OnPostInitScene()
    alt 不同类型 例如普通到异次元
        LogicManager [#blue]->o BaseTownLogic: OnPostInitScene
    else 相同之间切换
        LogicManager [#blue]->o LastBaseTownLogic: OnPostInitScene
    end

    ClientSystemTown [#blue]->o LogicManager : OnFinishSwitch()
    activate LogicManager #LightBlue
    LogicManager [#red]->o LogicManager: State: Running
    LogicManager [#blue]->o BaseTownLogic: 新类型 Enter()
    deactivate LogicManager
    ClientSystemTown -> MainPlayer : enable(true)
    ClientSystemTown -> ClientSystemTown : isswitcing(false)
    deactivate ClientSystemTown
else 正在切换中

    ClientSystemTown [#blue]->o LogicManager : OnError()
    activate LogicManager #LightBlue
    LogicManager [#red]->o LogicManager: State: None
    deactivate LogicManager
    alt 不同类型 例如普通到异次元
        LogicManager [#blue]->o BaseTownLogic: 新类型 Destroy() 
    else 相同之间切换
    end
    ClientSystemTown -> MainPlayer : enable(true)
    ClientSystemTown -> ClientSystemTown : isswitcing(false)
else 不能切换
    ClientSystemTown [#blue]->o LogicManager : OnError()
    activate LogicManager #LightBlue
    LogicManager [#red]->o LogicManager: State: None
    deactivate LogicManager
    alt 不同类型 例如普通到异次元
        LogicManager [#blue]->o BaseTownLogic: 新类型 Destroy() 
    else 相同之间切换
    end
    ClientSystemTown -> MainPlayer : enable(true)
    ClientSystemTown -> ClientSystemTown : isswitcing(false)
    deactivate BaseTownLogic
end


@enduml

PlantUML version 1.2020.10(Sun May 17 17:35:57 CST 2020)
(MIT source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) Client VM
Java Version: 1.8.0_251-b08
Operating System: Windows 10
Default Encoding: UTF-8
Language: zh
Country: CN
--></g></svg></p>
      </div>
      
      
    
    
    <script>
// config mermaid init call
// http://knsv.github.io/mermaid/#configuration
//
// You can edit the 'MERMAID_CONFIG' variable below.
MERMAID_CONFIG = {
  startOnLoad: false
}

if (window['MERMAID_CONFIG']) {
  window['MERMAID_CONFIG'].startOnLoad = false
  window['MERMAID_CONFIG'].cloneCssStyles = false
  window['MERMAID_CONFIG'].theme = "default"
}
mermaid.initialize(window['MERMAID_CONFIG'] || {})
if (typeof(window['Reveal']) !== 'undefined') {
  function mermaidRevealHelper(event) {
    var currentSlide = event.currentSlide
    var diagrams = currentSlide.querySelectorAll('.mermaid')
    for (var i = 0; i < diagrams.length; i++) {
      var diagram = diagrams[i]
      if (!diagram.hasAttribute('data-processed')) {
        mermaid.init(null, diagram, ()=> {
          Reveal.slide(event.indexh, event.indexv)
        })
      }
    }
  }
  Reveal.addEventListener('slidechanged', mermaidRevealHelper)
  Reveal.addEventListener('ready', mermaidRevealHelper)
} else {
  mermaid.init(null, document.getElementsByClassName('mermaid'))
}
</script>
    
    
    <script>
var flowcharts = document.getElementsByClassName('flow')
for (var i = 0; i < flowcharts.length; i++) {
  var flow = flowcharts[i]
  try {
    var diagram = flowchart.parse(flow.textContent)
    flow.id = 'flow_' + i
    flow.innerHTML = ''
    diagram.drawSVG(flow.id)
  } catch (error) {
    flow.innerHTML = '<pre class="language-text">' + error.toString() + '</pre>'
  }
}
</script>
    
    
  
    </body></html>