//
//  XYPlatform.h
//  XYPlatform
//
//  Created by Eason on 21/04/2014.
//  XY SDK v1.4.0 iPhoneOS XCode5
//  全民奇迹

#import <Foundation/Foundation.h>
#import <UIKit/UIKit.h>
#import "XYPlatformDefines.h"
#import "MGGameEventDataModel.h"

#ifndef XYPlatform
#define XYUserRegister MZPxtfuFFtAUsLKw
#define XYUserPlatform cDzJDeAAdGxhbXEt
#define XYUserInfoObj YMLSOKQCwBJPmavf
#define XYUserInfo hdPcMqEcEVmgpwHb
#define XYUserIdCard whccqEOVbeGvaSdU
#define XYUserDefault XJnIUMaicLyUGOFa
#define XYUserCenter iAWQbqaprFWYrDPy
#define XYUpdateAlertView TnbuFAJOkmJeQsnh
#define XYURLRequest BjjltMNgaMJsrzaf
#define XYToolBarParent viJNSdvUFyRmRMeZ
#define XYToolBarLeftView kUpQILPzGcZsCbIH
#define XYToolBar YQZbXxJeaTZwQSex
#define XYTabBarController EkSyEKhlyxXPEqnp
#define XYTTTAttributedLabel IhrhugrTVTcimooj
#define XYStorage OgflfjmKyZKPVkFd
#define XYStatistics sIIwwPpODvutpQRR
#define XYSegmentedControl UHaxysOjMnRsJuMj
#define XYSecureCenter IxOaIZWjKKwoIcMW
#define XYSecureCell koPixmEYFwRUBRKM
#define XYScrollView fKoqXXosiEgYCPru
#define XYSSKeychain AnrVtFvjueDtReGs
#define XYRootNaviController qjxJNqSJhziSufNF
#define XYResetPasswordVC WEMxSecIDUvRILpa
#define XYRegisterController RsgOvXxNnSYOtSIj
#define XYRegisterAgreementController appTXFmaTUyqXmss
#define XYRegisterAgreement AaKyORpmJaotInei
#define XYPullDownCancelButton uKhuircBLHlJivtE
#define XYPullDown PGmYKtZHxjDvcGbx
#define XYPlatform UGXHIKIxRoNvmpmc
#define XYPhoneRegisterController KsGndpyOLDwOTIbI
#define XYPhoneRegisterAgreement kKITytyLSeVjzIzZ
#define XYPayRecordObj LkVRlrBBAtCgbYRZ
#define XYPayOrderInfo BwyqOjHTgoNMYQpc
#define XYModifyUserSecret oHTPiaVXhPfwuqYK
#define XYModifySecret dxkKYjddrmvpYkkf
#define XYLowSafeAccountView MRIeRmLMhmyUREXe
#define XYLoginViewController tdcKmAMfUarTEftp
#define XYLoginPhoneRegistView sAwTelqdTpyFiMnL
#define XYLoginMenuView OaYGJMrDXUtxFtsx
#define XYLoginInfo TSIKPcyzrplFOjZN
#define XYLoginFooterView avvFWKVcYKsQGOnz
#define XYKeyWindow ZvfaYMFpkThPqXRv
#define XYKeyChainManager ryOABmrzbDciKWMC
#define XYKeyChain BPERptgdxssHZKJG
#define XYInAppPurchaseTool DBWDhuOtnLFfkKXI
#define XYImageSaveTool UisTaauOMgVolaxV
#define XYImageDownLoader GJIMQwtaRoruUSIm
#define XYIdentityVerificationContainerView zwJvnZAKZSjTDyON
#define XYIdentityVerificationAlertView WqwWukYbGcQOmKmQ
#define XYIAPModel RmaEmKwRFmmVZYJt
#define XYIAPBuyModel GbfKtvbQQAfcUyTV
#define XYHttpTransfer igqRuUPzPdAMXThP
#define XYHttpClient vTnVivEyWcGuOImO
#define XYHelperCell uAfyiwnvRAEEjaGw
#define XYHelper NagyZhLrzBcdRqmy
#define XYGetSafeQ DbrrefTHEhaXRVML
#define XYForgotPasswordController YJhLCmySoVJcEzem
#define XYFindPasswordObj SoiVeLPSTwakFgUB
#define XYDialogAlertView AqZbPrdvyvaTXGLq
#define XYDialogAlertContainerView jlcQYrMPofwUqNQq
#define XYConfiguration MmUQkKNxsHRyQmTH
#define XYComplementUserVC NaIbeuTAgsUrUyZk
#define XYClearView lTNbxGFTznEuIkBm
#define XYClearVC FyaCTDLnDpdpfxsu
#define XYChooseView XYYPMIxTzdyuZpQV
#define XYCheckBox ldXrlOKoGqFSJiOO
#define XYChangeAccountInfo ggzcLRCzSrEnlLXz
#define XYButton_XLine faZZOjcNvusJdSVF
#define XYBoundMobile zkevKSBnGEKyOYdl
#define XYBindAlertView pcZHXwwBtYGCYYZm
#define XYBind tYOZaEmTERbBDihI
#define XYBaseViewController hauwjJQDfFoWguro
#define XYBaseNavigationBar ugaRZATONAiGWKdU
#define XYBaseNavController qmnFbjZxdSVkcHMD
#define XYBBSController bKyMQNVNtTPDDrMm
#define XYAlertViewX RSoeZhtyKfrgvgHl
#define XYAlertViewRootVC yWwaQBkGKUbmXoHN
#define XYAlertView btGbjTEcxJDEnYdH
#define XYAlertCustomView oKYMExBwaFpPcsyk
#define XYAccountSettingInfo ZIQqkRQwbGoGxqQQ
#define XYAccount KNawfMsyUtvJiHdI
#define XYToken ZmzIrkekHAREduzx
#define XYEnterBindPhoneCompletion LCyjBJsMgATYcVMr
#define XYBuyProductWithModel STfBvcCdySkCmtRu
#define XYSetScreenOrientation odWJWFLXRTuSeaQO
#define XYUserRegisterM xSYPzAtHjKmBnBNY
#define XYLogout GbxhRbXQxhJELTCm
#define XYCreateRole QGNFzjwyJcShcUmV
#define XYOrderNumber kbNqfAzhXMqZpKqD
#define XYPhoneStatus igNgKYwpCBrhzjue
#define XYSetDebugModel CDozeteFyhgpppsK
#define XYSetShowSDKLog TNdNGHWMzIhRWHGO
#define XYAutoLogin OZkdtuPWjwMoHVgS
#define XYUserLogin HQzlAczNvosRpffZ
#define XYIsLogined cDdxJEuHeQBkbDAg
#define XYCreateRandomAccount wYsNEzQMmuuWjYVx
#define XYOpenUID OVxYvXaqMshcHjcN
#define XYLoginUserAccount JiRccKCOVpYAEsKo
#define XYidCardStatus lhjdzutLgtimZCFq
#define XYSwitchAccount xrNtGFsawIclqSvW
#define XYIsGuestLogined tAVjlGQomyNpoBrj
#define XYGuestRegister aBVlIzoLLpANIiPi
#define IAPToolSysWrong LgmbTOiCnFJPZUqM
#define IAPToolGotProducts OktiCmFleGEbnvdt
#define IAPToolBoughtProductSuccessedWithProductID ILifvGCBadAAKIrl
#define IAPToolCanceldWithProductID QVEbMpXijCWyXiab
#define IAPToolBeginCheckingdWithProductID uhlCeGzwXRIusMua
#define IAPToolCheckRedundantWithProductID dNoXEAshmiyMsggr
#define IAPToolCheckFailedWithProductID cgKZNArKFIrlrMGg
#define IAPToolRestoredProductID GETSUpNekFIBSIWk
#define XYIAPStartRequestProductsArray ltdQOjAscCnlGNaK
#define restoreProduct xLEzBCJMVYLGHAsc
#define getProductArray YPyrbsudsNjRoroM
#define XYIapWebViewViewController ptsvyZxVtTZJaOJu
#define showMsg IDtSyEKBDBQeWvLA


#endif


#pragma mark XYPlatform 基本信息

typedef NS_ENUM(NSInteger , aType){
    aTypeU,
    aTypeC,
    aTypeD,
};

@interface XYPlatform : NSObject

/**
 *   @brief 获取XYPlatform实例
 */
+ (XYPlatform*)defaultPlatform;

/**
 *   @brief 获取SDK版本号
 */
+ (NSString*)sdkVersion;

@end


#pragma mark XYPaltform 初始化配置

typedef void (^resultTypeBlock)(aType type,NSString *appid);

@interface XYPlatform (XYConfiguration)

/*
 * 是否切需要切小游戏 isLiteGame
 */
- (void)MGChoose:(BOOL)isLiteGame Completion:(resultTypeBlock)Completion;

- (void)loadAgain;


/**
 *	@brief  平台初始化方法
 *
 *  @param  appId 游戏在接入联运分配的appId
 *
 *
 *  @param  isAccept 检查游戏版本更新升级，若检查更新失败（网络错误或因后台报错）是否继续游戏，建议传YES(即：继续游戏，可能跳过强制更新），可根据版本需要传
 *
 *	@param	orientation	 游戏的初始方向
 */
- (void) initializeWithAppId:(NSString *) appId isContinueWhenCheckUpdateFailed:(BOOL)isAccept;

/**
 *  @brief  platform 初始化之后，获取 appid
 */
@property (nonatomic, strong, readonly) NSString *XY_APP_ID;

/**
 * @brief platform 初始化之后，获取 appkey
 */
@property (nonatomic, strong, readonly) NSString *XY_APP_KEY;

/**
 * @brief platform 初始化之后，获取 协议url
 */
@property (nonatomic, strong, readonly) NSString *Protocol_URL;

/**
 * @brief platform Resource ID
 */
@property (nonatomic, strong) NSString *XY_RESOURCE_ID;

/**
 * @brief platform 支付跳转url
 */
@property (nonatomic, strong, readonly) NSString *XY_jump_URL;

/**
 * @brief platform 获取订单号url 支付中心
 */
@property (nonatomic, strong, readonly) NSString *XY_ORDER_Url;

@property (nonatomic, strong, readonly) NSString *XY_SHOW_Url;


/**
 * @brief 改变竖屏前的方向
 */
@property (nonatomic, assign, readonly) UIDeviceOrientation MGInterfaceOrientation;


/**
 * @brief 初始化方向
 */
@property (nonatomic, assign, readonly) UIInterfaceOrientation XYInterfaceOrientation;

/**
 * @brief 是否 debug 模式
 */
@property (nonatomic, assign, readonly) BOOL isDebugModel;

/**
 *  @brief 设定初始时游戏的方向
 *      1、其中设置的方向需要在 app plist文件Supported interface orientations 中支持，否则会Assert
 *      2、UIInterfaceOrientation, 设置 UIInterfaceOrientationLandscapeLeft 或者 UIInterfaceOrientationLandscapeRight，平台页面仅支持横屏幕。
 *      3、设置 UIInterfaceOrientationPortrait ，平台仅支持Portrait方向
 *
 */
- (void)XYSetScreenOrientation:(UIInterfaceOrientation)orientation;

/**
 *  @brief 设置调试模式
 *
 *  @param debug YES 为测试环境, NO为 正式环境
 */
- (void)XYSetDebugModel:(BOOL)debug;


/**
 * @brief 打印log到控制台
 */
- (void)XYSetShowSDKLog:(BOOL)isShow;

/*
 *推出程序
 */
- (void)XYGameOut;

/**
 * @brief 显示悬浮球
 */
- (void)XYShowToolBar;

/**
 * @brief 隐藏悬浮球
 */
- (void) XYHideToolBar;

@end


#pragma mark-- 用户部分，登录、注册、登出、token、uid 等

typedef void (^resultCompletion)(NSString *phoneNum,BOOL status);
@interface XYPlatform (XYUserCenter)

/**
 *  @brief 检查用户登录状态，如不再登录状态，自动登录
 *
 *  @param iflag 默认传0
 *
 *  @result 预留，默认为0
 */
- (int) XYAutoLogin:(int) iflag;




/**
 *  @brief XYPlatform 注册界面入口
 *
 *  @param rFlag 标识(按位标识)预留, 默认为0
 *
 *  @result 错误码, 预留, 默认为0
 */
- (int)XYUserRegisterM:(int)rFlag;


/*
 * @brief 判断玩家登录状态，异步回调
 */
- (void)XYIsLogined:(void (^)(BOOL isLogined)) bLogined;


/**
 * 创建一个随机用户
 */
- (int)XYCreateRandomAccount:(int) cFlag;


/**
 *  @brief XYPlatform 注销, 即退出登录
 *
 *  @param lFlag 标识(按位标识), 0: 表示注销但保存本地信息;
 *
 *  @result 错误码, 预留, 默认为0
 */
- (int)XYLogout:(int)lFlag;


/**
 *  @brief 获取本次登录的token, 登录或注册之后返回, 有效期为7天
 */
- (NSString*) XYToken;

/**
 *  @brief 获取登录的openuid, 用于标记一个用户
 */
- (NSString*)XYOpenUID;

/**
 *  @brief 当前登录用户名
 */
- (NSString *) XYLoginUserAccount;

/**
 * status false -> 未绑定  yes -> 已经绑定
 * phoneNum 0  -> 未绑定    177****8123  -> 已经绑定
 */

- (void)XYPhoneStatus:(resultCompletion)Completion;

/**
 * @brief 检查当前用户是否绑定身份证
 * @return 0 未绑定 1 已绑定
 */
- (BOOL) XYidCardStatus;

/**
 * @brief 切换账号
 */
- (void) XYSwitchAccount;

/**
 *  检查当前是否为游客登录状态
 *
 *  @return 当前是否为游客登录。
 */
- (BOOL) XYIsGuestLogined;


/**
 * @brief 游客账户注册。注册完毕，游客账户变为正式账户，UID不会变，游戏方可以在比如用户升级到一定级别或者其他需要时强制玩家注册
 *
 * @param rFlag
 *
 * @result 默认返回0  返回1表示当前不是游客账户或者没有登录，不弹出游客注册页面
 */

- (int) XYGuestRegister:(int)rFlag;


//方法调用
- (void)runFun;

@end




#pragma mark-- GameCenter

@interface XYPlatform (XYGameCenter)

@end


#pragma mark-- 数据统计 创角+充值



@interface XYPlatform (XYDataStatistics)

/**
 * @brief 数据统计 创角
 *
 * @param role: 角色id  roleName: 角色名称 server: 区服(一般是数字)
 *
 */

- (void) XYCreateRole:(NSString *)role roleName:(NSString *)roleName gameServer:(NSString *)server;


/**
 * @brief 数据统计 充值
 *
 * @param money: (必须为数字类型，单位为分)  server: 服务器(必须为数字类型)
 *
 */
- (void) XYOrderNumber:(int)money gameServer:(int)server;

/*
 Data_type
 '1' => 'dataSelectServer',//选择区服 '2' => 'dataCreateRole',//创角成功----必传 '3' => 'dataEnterGame',//进入游戏----必传 '4' => 'dataLevelUp',//角色升级 '5' => 'dataQuitGame',//退出游戏 '6' => 'dataPay',//支付----必传 '7' => 'dataChat',//聊天 '8' => 'dataCreateRoleEnter',//进入创角页面----必传 '9' => 'dataCreateRoleClick',//点击创角按钮----必传
 
 role_id：角色id(必传)
 role_name：角色名称(必传)
 server_id：区服id(必传)
 server_name：区服名称(必传)
 level：角色等级(选传)
 job：职业(选传)
 data_type：上报类型(必传)
 diamonds：角色元宝数(选传)
 content：聊天内容(选传)
 chat_type：聊天类型(选传)
 */

//游戏点击事件
- (void)gameEventData:(MGGameEventDataModel *)data;


@end


//内购
#pragma mark-- IAP

//----------XYIAPBugModel--内购购买模型
@interface XYIAPBuyModel : NSObject

@property(nonatomic,strong)NSString *amount;
@property(nonatomic,strong)NSString *real_price;
@property(nonatomic,strong)NSString *appName;
@property(nonatomic,strong)NSString *appOrderID;
@property(nonatomic,strong)NSString *appUserID;
@property(nonatomic,strong)NSString *appUserName;
@property(nonatomic,strong)NSString *openUID;
@property(nonatomic,strong)NSString *productId;
@property(nonatomic,strong)NSString *productName;
@property(nonatomic,strong)NSString *SID;
@property(nonatomic,strong)NSString *packageName;
@property(nonatomic,strong)NSString *deviceType;
@property(nonatomic,strong)NSString *appkey;
@property(nonatomic,strong)NSString *callback_url;
@property(nonatomic,strong)NSString *url;
@property(nonatomic,strong)NSString *resource_id;
@property(nonatomic,strong)NSString *app_extra1;
@property(nonatomic,strong)NSString *app_extra2;

@end

//----------XYIAPModel--内购模型
@interface XYIAPModel : NSObject

@property(nonatomic,strong)NSString *localizedDescription;
@property(nonatomic,strong)NSString *localizedTitle;
@property(nonatomic,strong)NSString *price;
@property(nonatomic,strong)NSString *real_price;
@property(nonatomic,strong)NSString *productIdentifier;

@end

//----------XYIAPDelegate--内购代理

/**
 *  内购工具的代理
 */
@protocol XYIAPDelegate <NSObject>

/**
 *  代理：系统错误
 */
-(void)IAPToolSysWrong;

/**
 *  代理：已刷新可购买商品
 *
 *  @param products 商品数组
 */
-(void)IAPToolGotProducts:(NSMutableArray *)products;

/**
 *  代理：购买成功
 *
 *  @param productID 购买成功的商品ID
 */
-(void)IAPToolBoughtProductSuccessedWithProductID:(NSString *)productID
                                          andInfo:(NSDictionary *)infoDic;;

/**
 *  代理：取消购买
 *
 *  @param productID 商品ID
 */
-(void)IAPToolCanceldWithProductID:(NSString *)productID;

/**
 *  代理：购买成功，开始验证购买
 *
 *  @param productID 商品ID
 */
-(void)IAPToolBeginCheckingdWithProductID:(NSString *)productID;

/**
 *  代理：重复验证
 *
 *  @param productID 商品ID
 */
-(void)IAPToolCheckRedundantWithProductID:(NSString *)productID;

/**
 *  代理：验证失败
 *
 *  @param productID 商品ID
 */
-(void)IAPToolCheckFailedWithProductID:(NSString *)productID
                               andInfo:(NSData *)infoData;

/**
 *  恢复了已购买的商品（永久性商品）
 *
 *  @param productID 商品ID
 */
-(void)IAPToolRestoredProductID:(NSString *)productID;


@end



@interface XYPlatform (XYIAP)
/**
 * @brief 进入内购页面
 *
 *
 *
 */
- (void)XYIAPStartRequestProductsArray:(NSArray *)array WithDelegate:(id <XYIAPDelegate>)delegate;



/**
 * @brief 购买
 *
 * @param product 传入product 唯一表示
 *
 * @param ipa 是否强制 内购 购买 一般填写false
 */
-(void)XYBuyProductWithModel:(XYIAPBuyModel *)model iap:(BOOL)iap;

/**
 * @brief 恢复已购买的商品
 *
 * @param product 传入product 唯一表示
 *
 */

-(void)restoreProduct;




@end

#pragma mark-- 各种中心
typedef void (^resultBlock)(NSString *phoneNum,BOOL status);
typedef void (^resultGameBlock)(NSString *url,NSString *error);
@interface XYPlatform(Center)


/**
 * @brief 进入手机绑定
 * status false -> 未绑定  yes -> 已经绑定
 * phoneNum 0  -> 未绑定    177****8123  -> 已经绑定
 *
 */

- (void) XYEnterBindPhoneCompletion:(resultBlock)Completion;

/*
 *获取游戏地址
 *
 */
- (void)XYGetGameUrl:(resultGameBlock)Completion;

/*
 * 加载小游戏
 *
 */
- (void)MGLoadGameUrl:(NSString *)url;

@end










